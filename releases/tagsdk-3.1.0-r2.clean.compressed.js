(function(){var D,A;function J(){function a(b){k.events.push(b);f(k.listeners,function(a){if(!a.disposed&&d(a.type,b.meta.type))try{a.callback.call(a.context,b)}catch(c){console&&console.error&&console.error("Error emitting UV event",c.stack)}});c.shift();0<c.length&&a(c[0])}function f(a,b){for(var c=a.length,d=0;d<c;d++)b(a[d],d)}function e(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function d(a,b){return"string"===typeof a?a===b:a.test(b)}function b(a,b){for(var c=a.length,
d=[],k=0;k<c;k++)b(a[k])&&d.push(a[k]);return d}var c=[],k={emit:function(d,g){g=e(g||{});g.meta=g.meta||{};g.meta.type=d;c.push(g);1===c.length&&a(c[0]);k.listeners=b(k.listeners,function(a){return!a.disposed})},on:function(a,b,c){var e={type:a,callback:b,disposed:!1,context:c||window};k.listeners.push(e);var q={replay:function(){f(k.events,function(k){e.disposed||d(a,k.meta.type)&&b.call(c,k)});return q},dispose:function(){e.disposed=!0;return q}};return q},once:function(a,b,c){var d=k.on(a,function(){b.apply(c||
window,arguments);d.dispose()});return d},events:[],listeners:[]};return k}function L(){var a=G.uv;if(!a||!a.emit)return!1;if(!K){K=!0;for(var f=0;f<E.length;f++){var e=E[f];e.on?a.on.apply(a,e.on):e.emit&&a.emit.apply(a,e.emit)}a.on(/.*/,function(a){var b=a.meta.type,c=H[b];c?(c.current=a,c.history.push(a)):H[b]={current:a,history:[a]}}).replay();I=!0}return!0}(function(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
var f=Array.prototype.slice.call(arguments,1),e=this,d=function(){},b=function(){return e.apply(this instanceof d?this:a,f.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;b.prototype=new d;return b})})();var B={__anonymous__:!0},y=null;try{y=(0,eval)("this")||function(){return this}()}catch(M){}var B=y,h=B.qubit||{};B.qubit||(B.qubit=h);if(h.VERSION&&"3.1.0-r2"!==h.VERSION)try{console.warn("There is already 'qubit.VERSION' set to: "+h.VERSION)}catch(N){}h.VERSION="3.1.0-r2";
try{"object"===typeof module&&(module.exports=B)}catch(O){}var x=function(){};(function(){function a(){}function f(b,c,d,e,g){b=b.split(".");var p=a.NAMESPACE_BASE||B,f=null,q=null;g&&(p=y);g=p;p=d||p;for(d=0;d<b.length-1;d+=1)q=b[d],p[q]=p[q]||{},p=p[q];f=p;q=b[b.length-1];y.TAGSDK_NS_OVERRIDE&&(e=!1);void 0!==y.TAGSDK_NS_FORCED_OVERRIDE_OPTION&&(e=!y.TAGSDK_NS_FORCED_OVERRIDE_OPTION);void 0!==c?void 0!==f[q]&&e||(f[q]=c):f[q]=f[q]||{};c&&(c.CLASSPATH=b.join("."),b.splice(b.length-1,1),c.PACKAGE_NAME=
b.join("."));return{root:g,object:f,instance:f[q]}}a.global=function(){return y};a.STANDARD_CS_NS="qubit.cs";a.clientSpaceClasspath=function(){return window.qubit.CLIENT_CONFIG?"qubit.cs.d"+window.qubit.CLIENT_CONFIG.id:a.STANDARD_CS_NS};a.globalNamespace=function(a,c,d,e){return f(a,c,d,e,!0)};a.namespace=function(a,c,d,e){return f(a,c,d,e,!1)};a.clientNamespace=function(b,c,d,e){return a.namespace(a.clientSpaceClasspath()+"."+b,c,d,e)};a.clazz=function(b,c,d,e,g){a.namespace(b,c,e,!0);"function"===
typeof d&&(c.SUPER=d,c.superclass=d,c.prototype=new d(g),c.prototype.SUPER=d,c.prototype.CLASS=c);b=b.split(".");c.prototype?(c.prototype.CLASSPATH=b.join("."),c.prototype.CLASS_NAME=b[b.length-1],b.splice(b.length-1,1),c.prototype.PACKAGE_NAME=b.join(".")):(c.CLASSPATH=b.join("."),c.STATIC_NAME=b[b.length-1],b.splice(b.length-1,1),c.PACKAGE_NAME=b.join("."));return c};a.clazz("qubit.Define",a);a.clientClazz=function(b,c,d,e,g){return a.clazz(a.clientSpaceClasspath()+"."+b,c,d,e,g)};a.STANDARD_VS_NS=
"qubit.vs";a.vendorsSpaceClasspath=function(b){var c=h.VENDOR_SPACE_CP,c=void 0===c||null===c?a.STANDARD_VS_NS:c;return b?c?c+"."+b:b:c};var e=a.vendorsSpaceClasspath(),d;d=e?a.namespace(e,{},null,!0).instance:a.global();a.getVendorSpace=function(){return d};a.vendorNamespace=function(b,c,d,e){b=a.vendorsSpaceClasspath(b);return a.namespace(b,c,d,e)};a.vendorClazz=function(b,c,d,e,g){b=a.vendorsSpaceClasspath(b);return a.clazz(b,c,d,e,g)}})();(function(){function a(a){}for(var f={},e=0;93>e;e++)f["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=".charAt(e)]=
e;h.Define.clazz("qubit.Cookie",a);a.cookieAlphabet="abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-#$&+()@'%./:<>?[\"]^_`{|}~\\;=";a.cookieAlphabetMap=f;a.decode=function(a){return unescape(a)};a.encode=function(a){return escape(a)};a.set=function(d,b,c,e,l){if(c){var g=new Date;g.setTime(g.getTime()+864E5*c);c="; expires="+g.toGMTString()}else c="";l||(d=a.encode(d),b=a.encode(b));d=d+"="+b+c+"; path=/;";e&&(d+=" domain="+e);document.cookie=d};a.get=function(d,b){for(var c=d+"=",
e=document.cookie.split(";"),l=0;l<e.length;l++){for(var g=e[l];" "===g.charAt(0);)g=g.substring(1,g.length);if(0===g.indexOf(c))return c=g.substring(c.length,g.length),b||(c=a.decode(c)),c}return null};a.getAllForName=function(d,b){if(!d)return[];for(var c=d+"=",e=document.cookie.split(";"),l=[],g=0;g<e.length;g++){for(var p=e[g];" "===p.charAt(0);)p=p.substring(1,p.length);0===p.indexOf(c)&&(p=p.substring(c.length,p.length),b&&(p=a.decode(p)),l.push(p))}return l};a.getAll=function(d){for(var b=
document.cookie.split(";"),c=[],e=0;e<b.length;e++){for(var l=b[e];" "===l.charAt(0);)l=l.substring(1,l.length);var g=l.substring(0,l.indexOf("=")),l=l.substring(g.length+1,l.length);d&&(l=a.decode(l));c.push([g,l])}return c};a.rm=function(d,b){a.set(d,"",-1,b)}})();(function(){function a(a,s){for(var b=l.length,c=0;c<b;c++)if(a===l[c][0])return l[c][1];l[l.length]=[a,s];return!1}function f(n,s,b,c,m){var d=!1,e=!1,g=!1,p=!1,q=!1,v=q=!1;s&&(d=(q=!!s.all)||s.nodes,p=q||s.win,e=q,v=!!s.emptyForMaxDeep,
g=s.noFunctions&&!q,void 0!==s.noOwn&&(e=!!s.noOwn),void 0!==s.noFunctions&&(g=!!s.noFunctions),void 0!==s.win&&(p=!!s.win),void 0!==s.nodes&&(d=!!s.nodes),q=!!s.copyReference);if(void 0===b||b)void 0!==b&&b--;else return v?void 0:n;if(!(n&&n instanceof Object))return n;if(!d){try{if(n instanceof Node)return n}catch(r){if(n instanceof ActiveXObject&&void 0!==n.nodeType)return n}if(n===document)return n}if(!p&&n===k)return n;d=n instanceof Array?[]:{};n instanceof Date&&(d=new Date(n));!g&&n instanceof
Function&&(g=String(n).replace(/\s+/g,""),d=g.indexOf("{[nativecode]}")+14===g.length?function(){return n.apply(m||this,arguments)}:function(){return n.apply(this,arguments)});void 0===c&&(l=[],c=0);if(g=a(n,d))return g;if(d instanceof Array)for(g=0;g<n.length;g++)d[d.length]=n[g]===n[g]?f(n[g],s,b,c+1,n):n[g];else{var g=0,h;for(h in n){if(e||n.hasOwnProperty(h))d[h]=n[h]===n[h]?f(n[h],s,b,c+1,n):n[h];g++}}s.proto&&(d.prototype=f(n.prototype,s,b,c+1,n));q&&(d.___copy_ref=n);return d}function e(a,
s,b,c,m,d,p,l){b=b||{};void 0===b.hasOwn&&(b.hasOwn=!0);if(!b.objectsOnly||a instanceof Object)if(void 0===l||l){void 0!==l&&l--;if(!b||!b.nodes)try{if(a instanceof Node)return}catch(f){if(a instanceof ActiveXObject&&void 0!==a.nodeType)return}if(a!==k){void 0===c&&(g=[],c=0);var q;a:{for(q=0;q<c&&q<g.length;q++)if(a===g[q]){q=!0;break a}q=!1}if(!(q||(g[c]=a,m=m||a,m&&d&&m[d]!==m[d]||s(a,m,d,p)))){d=0;q="";for(var v in a){if(!b.hasOwn||a.hasOwnProperty(v))try{var r=a[v];b.track&&(q=p?p+"."+v:v);e(r,
s,b,c+1,m,v,q,l)}catch(h){}d++}}}}}var d=h.Define,b=h.Cookie,c=function(){},k=d.global();d.clazz("qubit.opentag.Utils",c);c.global=d.global;c.namespace=d.namespace;c.clazz=d.clazz;c.getObjectUsingPath=function(a,b){b=b||k;for(var c=a.split("."),m=0;m<c.length;m++)b&&c[m]&&(b=b[c[m]]);return b};c.getParentObject=function(a){var b=a.lastIndexOf(".");a=a.substring(0,b);return c.getObjectUsingPath(a)};c.variableExists=function(a){return void 0!==a&&null!==a};c.ANON_VARS=[];c.getAnonymousAcessor=function(a){var b=
c.indexInArray(a,c.ANON_VARS);-1===b&&(b=c.addToArrayIfNotExist(c.ANON_VARS,a));return"qubit.opentag.Utils.ANON_VARS["+b+"]"};c.replaceAll=function(a,b,c){return a.replace(new RegExp(b.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),c)};c.secureText=function(a){"string"!==typeof a&&(a+="");a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,"&gt;")};c.getUrl=function(){return document.location.href};c.getQueryParam=function(a){var b,m,d,e;b=c.getUrl();if(0<b.indexOf("?"))for(e=b.substring(b.indexOf("?")+
1).split("&"),b=0,m=e.length;b<m;b+=1)if(d=e[b],0<d.indexOf("=")&&(d=d.split("="),2===d.length&&d[0]===a))return d[1];return null};c.getElementValue=function(a){return(a=document.getElementById(a))?a.textContent||a.innerText:null};var l=[];c.objectCopy=function(a,b){b=b||{};var c=f(a,b,b.maxDeep);l=[];return c};var g=[];c.traverse=function(a,b,c){e(a,b,c,void 0,void 0,void 0,void 0,c.maxDeep)};c.prepareQuotedString=function(a){return"string"===typeof a?'"'+a.replace(/\"/g,'\\"')+'"':a};c.expressionToFunction=
function(a,b){return c.gevalAndReturn("function ("+(b||"")+") {"+a+"}").result};c.defineWrappedClass=function(a,b,c,m,e){var g=function(){return e?e.apply(this,arguments):b.apply(this,arguments)};d.clazz(a,g,b,m);for(var k in c)c.hasOwnProperty(k)&&"CONSTRUCTOR"!==k&&(g.prototype[k]=c[k]);return g};c.copyAandAddFromB=function(a,b,c){a=this.objectCopy(a,{maxDeep:c||8});for(var m in b)b.hasOwnProperty(m)&&(a[m]=b[m]);return a};c.keys=function(a){if(a instanceof Object){if(Object.keys)return Object.keys(a);
var b=[],c;for(c in a)a.hasOwnProperty(c)&&(b[b.length]=c);return b}throw"keys() called on non-object!";};c.getSrcElement=function(a){var b;a=a||window.event;a.srcElement?b=a.srcElement:a.target&&(b=a.target);return b};c.addToArrayIfNotExist=function(a,b,c){for(var m=0,d=!1;m<a.length;m+=1)if(c&&c(a[m],b)||a[m]===b){d=!0;break}d||(a[a.length]=b,m=-1);return m};c.indexInArray=function(a,b){for(var c=0,m=!1;c<a.length;c++)if(a[c]===b){m=!0;break}return m?c:-1};c.removeFromArray=function(a,b){for(var c=
0,m=0;c<a.length;)a[c]===b?(a.splice(c,1),m++):c++;return m};c.addClass=function(a,b){var m;try{a.classList.add(b)}catch(d){null===a.className?a.className=b:(m=a.className.split(" "),c.addToArrayIfNotExist(m,b),a.className=m.join(" "))}};c.removeClass=function(a,b){var m;try{a.classList.remove(b)}catch(d){null===a.className?a.className="":(m=a.className.split(" "),c.removeFromArray(m,b),a.className=m.join(" "))}};c.gevalAndReturn=function(a){var b=y;b.qubitopentagutilsgevalandreturn__var_test__=void 0;
b.qubitopentagutilsgevalandreturn__var_test__error=void 0;c.geval("try{this.qubitopentagutilsgevalandreturn__var_test__=("+a+");}catch(ex){this.qubitopentagutilsgevalandreturn__var_test__error = ex;}");a=b.qubitopentagutilsgevalandreturn__var_test__;var m=b.qubitopentagutilsgevalandreturn__var_test__error;try{b.qubitopentagutilsgevalandreturn__var_test__=void 0,b.qubitopentagutilsgevalandreturn__var_test__error=void 0,delete b.qubitopentagutilsgevalandreturn__var_test__,delete b.qubitopentagutilsgevalandreturn__var_test__error}catch(d){}return{result:a,
error:m}};c.trim=function(a){try{return String(a).trim()}catch(b){return String(a).replace(/^\s+|\s+$/g,"")}};c.setIfUnset=function(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&!a.hasOwnProperty(c)&&(a[c]=b[c])};c.overrideFromLeftToRight=function(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};c.geval=function(a){return window&&window.execScript?window.execScript(""===a?" ":a):k.eval.call(k,a)};var p=[];c.bodyAvailable=function(a){if(document.body){if(p){for(var b=0;b<p.length;b++)try{p[b]()}catch(c){}p=
!1}a()}else p.push(a)};c.rmCookiesMatching=function(a){for(var c=b.getAll(),m=0;m<c.length;m++){var d=c[m][0];0===d.match(a)&&b.rm(d)}};var r=[],q=!1,v=!1;c.bodyReady=function(a){if(v)return a&&a(),!0;if(q=q||!(!document.body||"complete"!==document.readyState)){v=!0;for(var b=0;b<r.length;b++)try{r[b]()}catch(c){}a&&a()}else a&&r.push(a);return q};var m=k.onload;k.onload=function(a){try{c.bodyReady()}catch(b){try{window.qubit.opentag.Utils.bodyReady()}catch(d){}}var e=!1;try{e=m}catch(g){}e&&e(a)};
(function(){var a,b=!1,m=1,d,e,g,k;e=function(a){!0===a&&(m-=1);if(!m||!0!==a&&!b){if(!document.body)return setTimeout(e,1);b=!0;if(!0!==a&&(m-=1,0<m))return;for(;0<d.length;)a=d.shift(),a()}};k=function(){if(!b){try{document.documentElement.doScroll("left")}catch(a){setTimeout(k,1);return}e()}};g=function(){if(!d){d=[];if("complete"===document.readyState)return setTimeout(e,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",e,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",
a);window.attachEvent("onload",e);var b=!1;try{b=null===window.frameElement||void 0===window.frameElement}catch(c){}document.documentElement.doScroll&&b&&k()}}};document.addEventListener?a=function(){document.removeEventListener("DOMContentLoaded",a,!1);e()}:document.attachEvent&&(a=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",a),e())});(function(a){g();b?setTimeout(a,1):d.push(a)})(function(){q=!0;c.bodyReady()})})()})();(function(){function a(b,c,n){this.collectLogs=
!!a.isCollecting();this.collectLocally=n;this.collection=[];this.getPrefix=function(){var a="";c&&("function"===typeof c?a=c(this.ref):c.CLASS_NAME?a=c.CLASS_NAME:c.constructor&&c.constructor.name&&(a=c.constructor.name),a&&(a+=" -> "));return(b||"")+a}}function f(c,m,n,d,e,g,k,p){var l=b>=p;if(0<=a.getCollectLevel()||l)m=e?[d,k,n]:[m+c.getPrefix()+d,g,n],m[3]=p,c.collect(m,p),l&&c.printMessage.apply(c,m)}var e=h.Define,d=null;e.clazz("qubit.opentag.Log",a);a.LEVEL_FINEST=4;a.LEVEL_FINE=3;a.LEVEL_INFO=
2;a.LEVEL_WARN=1;a.LEVEL_ERROR=0;a.LEVEL_NONE=-1;a.MAX_LOG_LEN=1E4;a.prototype.MAX_LOG_LEN=-1;var b=a.LEVEL_NONE,c=a.LEVEL_NONE,k=!0;a.setLevelFromCookie=function(){var b=h.Cookie.get("qubit.opentag.Log.LEVEL");if(b&&(b=+b,!isNaN(b)&&0<b)){var c=a.LEVEL_FINE;a.setCollectLevel(b>c?b:c);a.setLevel(+b)}};a.setCollecting=function(a){k=!!a};a.isCollecting=function(){return k||a.COLLECT};a.setLevel=function(a){b=+a};a.setCollectAndLevel=function(b){a.setLevel(b);a.setCollectLevel(b)};a.getLevel=function(){return b};
a.setCollectLevel=function(a){c=+a};a.getCollectLevel=function(){return c};var l=[];a.logsCollection=l;a.rePrintAll=function(c,m,n,e){var g=b;void 0!==c&&(b=c);try{if(a.isCollecting()){try{n||d.clear()}catch(k){}var p=e||a.logsCollection,l=0;for(n=0;n<p.length;n++)(function(n){var d=p[n];n=d[3];void 0!==n&&b>=n&&(l++,m?h.opentag.Timed.setTimeout(function(){void 0!==c&&(b=c);try{a.print.apply(a,d)}finally{b=g}},l*m):a.print.apply(a,d))})(n)}}catch(f){}finally{b=g}};var g=e.global(),p=!!(g.webkitMediaStream||
g.webkitURL||g.mozContact);a.isStyleSupported=function(){return p};var r={};a.setConsole=function(a){return d=a||r};a.delayPrint=-1;var q=(new Date).valueOf();a.prototype.printMessage=function(b,c,n,d){if(0<a.delayPrint){var e=a.delayPrint,g=q-(new Date).valueOf();0<g&&(e+=g);try{h.opentag.Timed.setTimeout(function(){this.print(b,c,n,d)}.bind(this),e)}catch(k){setTimeout(function(){this.print(b,c,n,d)}.bind(this),e)}q=(new Date).valueOf()+e}else this.print(b,c,n,d)};a.prototype.print=function(b,c,
n,d){a.print(b,c,n,d)};a.print=function(c,m,n,e){if(!(void 0!==e&&b<e))try{if(d&&d.log)if(m&&a.isStyleSupported())if(n&&d[n])d[n]("%c"+c,m);else d.log("%c"+c,m);else if(n&&d[n])d[n](c);else d.log(c)}catch(g){}};a.prototype.collect=function(b,c){void 0===c&&(c=a.getCollectLevel());var n=!1,d=this.collectLogs&&a.isCollecting()&&a.getCollectLevel()>=+c;d&&(l.push(b),n=!0);this.collectLocally&&d&&(this.collection.push(b),n=!0);0<a.MAX_LOG_LEN&&l.length>a.MAX_LOG_LEN&&l.splice(0,l.length-a.MAX_LOG_LEN);
if(0<a.MAX_LOG_LEN||0<this.MAX_LOG_LEN)d=a.MAX_LOG_LEN,0<this.MAX_LOG_LEN&&(d=this.MAX_LOG_LEN),this.collection.length>d&&this.collection.splice(0,this.collection.length-d);return n?b:null};a.clearAllLogs=function(){try{d.clear()}catch(a){}finally{l.splice(0,l.length)}};a.getCollectedByLevel=function(a,b){b=b||l;for(var c=[],d=0;d<b.length;d++){var e=b[d];e[0][4]===a&&c.push(e)}return c};a.prototype.rePrint=function(b,c,d){a.rePrintAll(b,c,!d,this.collection)};a.prototype.FINEST=function(b,c){f(this,
"FINEST: ",!1,b,c,"color:#CCCCCC;",!1,a.LEVEL_FINEST)};a.prototype.FINE=function(b,c){f(this,"FINE: ",!1,b,c,"color:#999999;",!1,a.LEVEL_FINE)};a.prototype.INFO=function(b,c,d){f(this,"INFO: ","info",b,c,d,d,a.LEVEL_INFO)};a.prototype.WARN=function(b,c){f(this,"WARN: ","warn",b,c,"color:#26A110;",!1,a.LEVEL_WARN)};a.prototype.ERROR=function(b,c){f(this,"ERROR: ","error",b,c,"color:red;",!1,a.LEVEL_ERROR)};a.setConsole(e.global().console);a.setLevelFromCookie()})();(function(){function a(a){a&&(this._rate=
a.rate||10,this._smallestRate=-1,a.start&&this.startPooling(),this.config=a);this.inervals=[];this._lck_obj={};this._binded_pool=this._pool.bind(this)}h.Define.clazz("qubit.opentag.Timer",a);a.prototype.timers=[];a.prototype.startPooling=function(a){a&&this.config.dynamic&&(0>this._smallestRate||this._smallestRate>a)&&(this._smallestRate=Math.min(Math.floor(a/2),1500));this.started||(this.started=!0,setTimeout(this._binded_pool,0))};a.prototype._pool=function(){this.maxFrequent(function(){},5E3,this._lck_obj);
this.callTimers();0!==this.timers.length?setTimeout(this._binded_pool,this._smallestRate>this._rate?this._smallestRate:this._rate):(this.started=!1,this._smallestRate=-1)};a.prototype.callTimers=function(){this.lastCalled=(new Date).valueOf();for(var a=0;a<this.timers.length;a++){var d=this.timers[a];if((new Date).valueOf()>=d.time){try{d.execute()}catch(b){}this.timers.splice(a,1);--a}}};a.prototype.cancellAll=function(){this.timers=[]};a.prototype.setRate=function(a){this._rate=a};a.prototype.maxFrequent=
function(a,d,b){b||(a.__maxFrequent__timer_opentag_qubit_=a.__maxFrequent__timer_opentag_qubit_||{},b=a.__maxFrequent__timer_opentag_qubit_);var c=b.____last__timed__max__frequent____;if(!c||(new Date).valueOf()-c>d)c=(new Date).valueOf(),b.____last__timed__max__frequent____=c,a()};a.prototype.runIfNotScheduled=function(a,d,b){b=b||a;if(b.__lastRun__&&(new Date).valueOf()<d+b.__lastRun__)return this.schedule(a,d,b);b.__lastRun__=(new Date).valueOf();a();return!0};a.prototype.schedule=function(a,d,
b){if(b.___scheduled___)return!1;b.___scheduled___=(new Date).valueOf();this.setTimeout(function(){b.___scheduled___=!1;b.__lastRun__=(new Date).valueOf();a()},d);return!0};var f=1;a.prototype.setTimeout=function(a,d){var b={id:f++,time:(new Date).valueOf()+ +d,execute:a};this.timers.push(b);this.startPooling(d);return b};a.prototype.setInterval=function(a,d){var b=setInterval(a,d);this.inervals.push(b);return b}})();(function(){h.Define.namespace("qubit.opentag.Timed",new h.opentag.Timer({rate:37,
dynamic:!0}));var a=h.opentag.Timed;a.tillTrue=function(f,e,d){var b=function(){f()?e():a.setTimeout(b,d||33)};b()}})();var t;t=t||{};t.fileLoader={};t.fileLoader.load=function(a,f,e,d,b,c){var k,l,g,p;p=!1;g=function(b){return function(){p||(p=!0,b&&!l&&(l={url:document.location.href}),e(a,l,b))}};try{f&&(k=f(a))}catch(r){k=!1,e(a,"Exception loading pre",!0)}finally{!1!==k&&(f=t.fileLoader.createScriptEl(a,b,!1,c),e&&(f.onload=g(!1),f.onerror=g(!0),f.onreadystatechange=function(){"complete"!==this.readyState&&
"loaded"!==this.readyState||setTimeout(function(){g(!1)()},1)}),d||(d=window.document.getElementsByTagName("head")[0]),d.appendChild(f))}};t.fileLoader.createScriptEl=function(a,f,e,d){var b,c=document.createElement("script");c.type="text/javascript";c.src=t.fileLoader.tidyUrl(a)+(e?"?"+(new Date).getTime():"");!1!==f?(c.async="true",c.defer="true"):(c.async="false",!1!==c.async&&(c.async=!1),c.defer="false",!1!==c.defer&&(c.defer=!1));for(b in d)d.hasOwnProperty(b)&&c.setAttribute(b,d[b]);return c};
t.fileLoader.tidyUrl=function(a){return"http:"===a.substring(0,5)||"https:"===a.substring(0,6)?a:"//"+a};(function(){function a(a){this.log=new h.opentag.Log("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.config={order:0,include:!0,name:"Filter-"+e++,script:void 0,session:void 0};this.session=null;if(a){for(var c in a)a.hasOwnProperty(c)&&(this.config[c]=a[c]);a.session&&this.setSession(a.session);this.register(this)}}var f=h.opentag.Utils,e=0,d=[];h.Define.clazz("qubit.opentag.filter.BaseFilter",
a);a.state={DISABLED:-3,SESSION:-2,PASS:-1,FAIL:0};a.prototype.reset=function(){this.enable()};a.prototype.disable=function(){this.config.disabled=!0};a.prototype.enable=function(){this.config.disabled=!1};a.prototype.match=function(){return!0};a.prototype.setSession=function(a){this.session=a};a.prototype.getSession=function(){return this.session};a.prototype.getState=function(){var b=a.state.PASS;if(this.config.disabled)return a.state.DISABLED;this.config.script&&(b=this.config.script.call(this,
b));isNaN(+b)&&(b=a.state.FAIL);this.lastState=+b;return b};a.getFilters=function(){return d};a.prototype.register=function(){a.register(this)};a.register=function(a){f.addToArrayIfNotExist(d,a)}})();h.Define.namespace("qubit.opentag.filter.pattern.PatternType",{CONTAINS:"CONTAINS",MATCHES_EXACTLY:"MATCHES_EXACTLY",STARTS_WITH:"STARTS_WITH",ENDS_WITH:"ENDS_WITH",REGULAR_EXPRESSION:"REGULAR_EXPRESSION",ALL_URLS:"ALL_URLS"});(function(){function a(d){this._lockObject={};var b={patternType:e.CONTAINS,
pattern:""};if(d)for(var c in d)d.hasOwnProperty(c)&&(b[c]=d[c]);a.SUPER.call(this,b)}var f=h.opentag.Utils,e=h.opentag.filter.pattern.PatternType;h.Define.clazz("qubit.opentag.filter.URLFilter",a,h.opentag.filter.BaseFilter);a.prototype.PATTERNS=e;a.prototype.getURL=function(a){return a||f.getUrl()};a.prototype.match=function(a){a=this.getURL(a);var b=!0,c=this.config.pattern;switch(this.config.patternType){case e.CONTAINS:b=0<=a.toLowerCase().indexOf(c.toLowerCase());break;case e.MATCHES_EXACTLY:b=
a.toLowerCase()===this.config.pattern.toLowerCase();break;case e.STARTS_WITH:b=0===a.toLowerCase().indexOf(c.toLowerCase());break;case e.ENDS_WITH:b=a.lastIndexOf(c.toLowerCase())+c.length===a.length;break;case e.REGULAR_EXPRESSION:b=(new RegExp(c)).test(a);break;case e.ALL_URLS:b=!0}return b}})();(function(){function a(b){var c={};if(b){for(var e in b)b.hasOwnProperty(e)&&("customStarter"===e&&b[e]?this.customStarter=b[e]:"customScript"===e&&b[e]&&(this.customScript=b[e]),c[e]=b[e]);this.uid="f"+
d++}this.tagsToRun=[];a.SUPER.call(this,c)}var f=h.opentag.filter.BaseFilter,e=h.opentag.Utils,d=0;h.Define.clazz("qubit.opentag.filter.Filter",a,h.opentag.filter.URLFilter);a.prototype.customStarter=function(a,c,d){c(!1)};a.prototype.isSession=function(){return this.config.sessionDisabled||null===this.customStarter&&null===this.customScript?!1:!0};a.prototype.customScript=function(a){return!0};a.prototype.match=function(b){var c=!0;try{this.customScript&&(void 0===this._matchState&&(this._matchState=
!!this.customScript(this.getSession())),c=this._matchState)}catch(d){c=!1}return c&&a.SUPER.prototype.match.call(this,b)};a.prototype.runTag=function(b){e.addToArrayIfNotExist(this.tagsToRun,b);if(this.starterExecuted)this._triggerTag(b);else if(!this._starterWasRun){this._starterWasRun=!0;var c=function(a){this.reRun=a;this.starterExecuted=(new Date).valueOf();this._processQueuedTagsToRun()}.bind(this);this.customStarter?this.customStarter(this.getSession(),c,b):a.prototype.customStarter.call(this,
this.getSession(),c,b)}};a.prototype._processQueuedTagsToRun=function(){for(var a=0;a<this.tagsToRun.length;a++)this._triggerTag(this.tagsToRun[a])};a.prototype._triggerTag=function(a){!0===this.reRun?a.run():a.runOnce()};a.prototype.getState=function(b){b&&this.setSession(b);b=a.SUPER.prototype.getState.call(this);if(b===f.state.DISABLED)return f.state.DISABLED;b===f.state.PASS&&this.isSession()&&(b=f.state.SESSION);this.config.script&&(b=this.config.script.call(this,b,this.getSession()));return this.lastState=
b};a.prototype.reset=function(){this._matchState=void 0;a.SUPER.prototype.reset.call(this);this.starterExecuted=this._starterWasRun=void 0;this.tagsToRun=[];this.reRun=void 0}})();t.GlobalEval={};t.GlobalEval.globalEval=function(a){window.execScript?window.execScript(""===a?" ":a):window.eval.call(window,a)};t.HtmlInjector={};t.HtmlInjector.inject=function(a,f,e,d,b){var c,k,l,g;if(0<=e.toLowerCase().indexOf("<script")){b=document.createElement("div");b.innerHTML="a"+e;k=b.getElementsByTagName("script");
l=[];e=0;for(c=k.length;e<c;e+=1)l.push(k[e]);g=[];e=0;for(c=l.length;e<c;e+=1){k=l[e];var p={attributes:t.HtmlInjector.getAttributes(k)};k.src?p.src=k.src:p.script=k.innerHTML;g.push(p);k.parentNode.removeChild(k)}b.innerHTML&&0<b.innerHTML.length&&(b.innerHTML=b.innerHTML.substring(1));t.HtmlInjector.doInject(a,f,b);t.HtmlInjector.loadScripts(g,0,d,a)}else b=document.createElement("div"),b.innerHTML=e,t.HtmlInjector.doInject(a,f,b),d&&d()};t.HtmlInjector.doInject=function(a,f,e){if(0<e.childNodes.length){for(var d=
document.createDocumentFragment();0<e.childNodes.length;)d.appendChild(e.removeChild(e.childNodes[0]));f?t.HtmlInjector.injectAtStart(a,d):t.HtmlInjector.injectAtEnd(a,d)}};t.HtmlInjector.injectAtStart=function(a,f){0===a.childNodes.length?a.appendChild(f):a.insertBefore(f,a.childNodes[0])};t.HtmlInjector.injectAtEnd=function(a,f,e){e||(e=1);a===document.body&&"complete"!==document.readyState&&50>e?setTimeout(function(){t.HtmlInjector.injectAtEnd(a,f,e+1)},100):a.appendChild(f)};t.HtmlInjector.loadScripts=
function(a,f,e,d){var b,c,k=!1;for(b=a.length;f<b;f+=1)if(c=a[f],c.src){k=!0;break}else t.GlobalEval.globalEval(c.script);k&&t.fileLoader.load(c.src,null,function(){t.HtmlInjector.loadScripts(a,f+1,e,d)},d,!1,c.attributes);e&&f===b&&e()};t.HtmlInjector.getAttributes=function(a){var f,e,d,b,c={};if(a){e=a.attributes;f=e.length;for(a=0;a<f;a++)d=e[a].value,b=e[a].name.toLowerCase(),""===d||"id"!==b&&"class"!==b&&"charset"!==b&&"data-"!==b.substr(0,5)||(c[b]=d);return c}};(function(){function a(){r=
r||{write:document.write,writeln:document.writeln}}function f(){document.write=r.write;document.writeln=r.writeln;r=null}var e=h.opentag.filter.BaseFilter,d=h.opentag.Utils,b=t.HtmlInjector,c=t.fileLoader,k=h.opentag.filter.Filter,l=function(){};h.Define.clazz("qubit.opentag.TagsUtils",l);var g=!1;l.bodyLoaded=function(){return g?!0:g=!(!document.body||"loading"===document.readyState)};l.bodyAvailable=function(a){return!!document.body};var p={};l.loadScript=function(a){var b=a.url,d=function(c,d,
n){p[b].error=d;n?(p[b].state="failure",a.onerror()):(p[b].state="success",a.onsuccess())};if(p[b]){if(a.noMultipleLoad)return d(b,p[b].error,"failure"===p[b].state);p[b].count+=1}else p[b]={count:1,state:null};var n=!a.async,m=l.bodyLoaded();n&&!m?l.writeScriptURL(b,function(a,c){d(b,c,!a)}):c.load(b,!1,d,a.node,a.async)};var r=null;l.redirectDocumentWritesToArray=function(b,c){a();document.write=function(a){b.push(a)};document.writeln=function(a){b.push(a)}};l.flushDocWritesArray=function(a,b,c,
d,n){if(b&&a){a=a.splice(0,a.length);try{return l.injectHTML(b,c,a.join("\n"),n||x),!0}catch(m){}}else return!1;n&&n();return!0};l.unlockDocumentWrites=function(){r&&f()};var q=l.prototype.PACKAGE_NAME+".TagsUtils._writeScriptURL_callbacks",v={};h.Define.namespace(q,v,y,!0);var m=0,n=(new Date).valueOf();l.writeScriptURL=function(b,g){var e="_"+n+"_"+m++,s=q+"."+e,k=!1;v[e]=function(a){k||(k=!0,a?g(!1,"error while loading script "+b):g(!0),v[e]=void 0,delete l.writeScriptURL.callbacks[e])};var p=
'if(this.readyState === "loaded" || this.readyState === "complete"){ try {'+s+"(true)} catch (ex) {}}",w="try{"+s+"(false)}catch(ex){}",s="try{"+s+"(true)}catch(ex){}";b=c.tidyUrl(b);p="<script onload='"+w+"'  onerror='"+s+"' onreadystatechange='"+p+"' type='text/javascript'  src='"+b+"'>\x3c/script>";r?(f(),document.write(p),a()):document.write(p);d.bodyReady(function(){k||(k=!0,g(!0))})};l.writeScriptURL.callbacks={};var s=e.state.SESSION,w=e.state.PASS,u=e.state.FAIL;l.filtersState=function(a,
b,c,d){a=a.sort(function(a,b){try{var c=b.config.order,d=a.config.order;isNaN(-d)&&(d=0);isNaN(-c)&&(c=0);return c-d}catch(n){return 0}});var n=w;if(!a||0===a.length)return n;for(var n=null,m=!1,g=!1,p=0,l,f,q=[],r,h,v=0;v<a.length;v++)if(r=a[v],r.setSession(b),r.match())if(l=r.getState(),0<l){if(0===p||p>l)p=l}else l===e.state.DISABLED?m=!0:l===s?(g=!0,f=n=r,q.push(r)):n=r;else h=r;a=!1;null===n?(a=!0,n=m?w:u):n=n.config.include?l:l===w?u:w;0<p&&(n===w||a)&&(n=p);if(n===s||n===w&&g){if(!f.config.include)return u;
n=s;if(f instanceof k&&f.isSession()&&d)for(d=0;d<q.length;d++)try{q[d].runTag(c)}catch(t){}}c.config.dedupe&&n===w&&h&&h instanceof k&&h.isSession()&&(c.sendDedupePing=!0,n=u);return n};l.injectHTML=function(a,c,d,n){return b.inject(a,c?0:1,d,n||x)};l.getHTMLLocationForTag=function(a){a=a.prepareLocationObject(a.config.locationObject);switch(a){case "HEAD":a=document.getElementsByTagName("head")[0];break;case "BODY":a=document.body;break;default:a=a?document.getElementById(a):document.body}return a}})();
(function(){function a(c){this.config={};this.handlers=[];this.parameters=null;this.callHandlersOnRead=!1;if(c){this.uniqueId="BV"+b++;a.ALL_VARIABLES[this.uniqueId]=this;for(var d in c)c.hasOwnProperty(d)&&(this.config[d]=c[d],"value"===d&&(this.value=c.value));return a.register(this)}}function f(){if(k)return!1;for(var b=0;b<c.length;b++)try{c[b].getValue()}catch(e){}d.setTimeout(f,a.CHECK_POLL_RATE);return!0}var e=h.opentag.Utils,d=h.opentag.Timed,b=0;h.Define.clazz("qubit.opentag.pagevariable.BaseVariable",
a);a.ALL_VARIABLES={};var c=[];a.OBSERVED_VARIABLES=c;a.pageVariables=[];a.register=function(b){if(b instanceof a){for(var c=0;c<a.pageVariables.length;c++){var d=a.pageVariables[c];if(b===d)return d}a.pageVariables.push(b);return b}return null};a.prototype.getValue=function(){this._updateCurrentValue(this.value);return this.currentValue};a.prototype._updateCurrentValue=function(a){return this.valuesAreEqual(a,this.currentValue)?!1:(this.oldValue=this.currentValue,this.currentValue=a,k&&!this.callHandlersOnRead||
this._handleValueChanged(),!0)};a.prototype.getDefaultValue=function(){return this.defaultValue};a.prototype.setDefaultValue=function(a){this.defaultValue=a};a.prototype.exists=function(a){var b=e.variableExists(this.getValue());a&&(b=b||e.variableExists(this.getDefaultValue()));return b};a.prototype.getRelativeValue=function(a,b){var c=this.getValue();e.variableExists(c)||(c=b);var d;a&&!e.variableExists(c)&&(d=this.getDefaultValue(),e.variableExists(d)&&(c=d));return c};a.prototype.replaceToken=
function(a,b,c,d){var k=this.exists();c=k?this.getValue():c;a="\\$\\{"+a+"\\}";return d||c instanceof Array?(d=k?this.getValueAccessorString():e.getAnonymousAcessor(c),b.replace(new RegExp(a,"g"),d)):b.replace(new RegExp(a,"g"),c)};a.prototype.getAccessorString=function(){return"qubit.opentag.pagevariable.BaseVariable.ALL_VARIABLES."+this.uniqueId};a.prototype.getValueAccessorString=function(){return this.getAccessorString()+".getValue()"};a.prototype.onValueChanged=function(a,b){e.addToArrayIfNotExist(this.handlers,
a);!1!==b&&this.startObservingForChanges()};a.prototype.deatchOnValueChanged=function(a){e.removeFromArray(this.handlers,a)};a.prototype._handleValueChanged=function(){for(var a={oldValue:this.oldValue,newValue:this.currentValue,variable:this},b=0;b<this.handlers.length;b++)try{this.handlers[b](a)}catch(c){}};var k=!0;a.CHECK_POLL_RATE=333;a.prototype.startObservingForChanges=function(){this.addToObservedVariables();k&&(k=!1,f())};a.prototype.stopObservingForChanges=function(){this.removeFromObservedVariables();
0===c.length&&(k=!0)};a.prototype.addToObservedVariables=function(){e.addToArrayIfNotExist(c,this)};a.prototype.removeFromObservedVariables=function(){e.removeFromArray(c,this)};a.prototype.getObservedVariables=function(){return c};a.prototype.valuesAreEqual=function(a,b){return a===b}})();(function(){function a(e){this._lockExprObject={};a.SUPER.apply(this,arguments)}var f=h.opentag.Utils;h.Define.clazz("qubit.opentag.pagevariable.Expression",a,h.opentag.pagevariable.BaseVariable);a.prototype.getValue=
function(){var e,d,b=this.value;try{if(b&&-1===b.indexOf("[#]")){var c=f.gevalAndReturn(b);e=c.result;this.failMessage=null;d=c.error}else e=a.parseUVArray(b)}catch(k){d=k}d&&(e="could not read value of expression: \n"+b+"\nexact cause: "+d,this.failMessage!==e&&(this.failMessage=e),e=null);this._updateCurrentValue(e);return e};a.parseUVArray=function(a){var d=a.split("[#]");a=f.gevalAndReturn(d[0]).result;var b=[],d=d[1];0===d.indexOf(".")&&(d=d.replace(".",""));for(var c=0;c<a.length;c++){var k=
f.getObjectUsingPath(d,a[c]);b.push(k)}return b};a.prototype.replaceToken=function(e,d,b,c){this.getValue()instanceof Array&&(c=!0);return a.SUPER.prototype.replaceToken.call(this,e,d,b,c)}})();(function(){function a(e){a.SUPER.apply(this,arguments)}var f=h.opentag.Utils;h.Define.clazz("qubit.opentag.pagevariable.DOMText",a,h.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=f.getElementValue(this.value);this._updateCurrentValue(a);return a}})();(function(){function a(f){a.SUPER.apply(this,
arguments);this._lockObject={}}h.Define.clazz("qubit.opentag.pagevariable.Cookie",a,h.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=h.Cookie.get(this.value);this._updateCurrentValue(a);return a}})();(function(){function a(e){a.SUPER.apply(this,arguments)}var f=h.opentag.Utils;h.Define.clazz("qubit.opentag.pagevariable.URLQuery",a,h.opentag.pagevariable.BaseVariable);a.prototype.getValue=function(){var a=f.getQueryParam(this.value);this._updateCurrentValue(a);return a}})();
(function(){function a(){}function f(a,b){var c=[];try{var d=a.parameters;if(d)for(var m=0;m<d.length;m++)a.getVariableForParameter(d[m])===b&&c.push(d[m])}catch(n){}return c}var e=h.opentag.Utils,d=h.opentag.TagsUtils,b=h.opentag.pagevariable.BaseVariable,c=h.opentag.pagevariable.Expression,k=h.opentag.pagevariable.DOMText,l=h.opentag.pagevariable.Cookie,g=h.opentag.pagevariable.URLQuery;h.Define.clazz("qubit.opentag.TagHelper",a);a.injectHTMLForLoader=function(a,b,c,e){if(e=void 0!==e?e:a.getHtml()){var m=
"END"===a.config.locationPlaceHolder,n=d.getHTMLLocationForTag(a);a.injectHTMLNotFinished=!0;try{n?d.injectHTML(n,m,e,function(){a.injectHTMLNotFinished=!1;if(b)try{b()}catch(c){}}.bind(a)):c&&"loading"===document.readyState?(document.write(e),a.injectHTMLNotFinished=!1):a.injectHTMLFailed=(new Date).valueOf()}catch(g){a.injectHTMLNotFinished=!1,a.injectHTMLFailed=(new Date).valueOf()}}};a.getAllVariablesWithParameters=function(a){for(var b=a.getPageVariables(),c=[],d=0;d<b.length;d++)for(var m=b[d],
n=f(a,m),e=0;e<n.length;e++)c.push({parameter:n[e],variable:m});return c};a.allParameterVariablesReadyForTag=function(a,b){for(var c=!0,d=a.getPageVariables(),m=0;m<d.length;m++){var n=d[m];try{var e=f(a,n),g=n.exists();!g&&b&&(0<e.length&&(g=!!e[0].defaultValue),g=g||n.exists(!0));if(!g){c=!1;break}}catch(k){c=!1;break}}return c};a.validateAndGetVariableForParameter=function(b){b.hasOwnProperty("variable")&&b.variable&&(b.variable=a.initPageVariable(b.variable));return b.variable};a.initPageVariable=
function(a){if(!a||a instanceof b)return a;if("string"===typeof a){var d=e.getObjectUsingPath(a);if(d&&d instanceof b)return d}switch(a.type){case "2":return new c(a);case "3":return new g(a);case "4":return new l(a);case "5":return new k(a);case "EPRESSION":return new c(a);case "URL_PARAMETER":return new g(a);case "COOKIE_VALUE":return new l(a);case "DOM_VALUE":return new k(a);default:return new b(a)}}})();(function(){function a(a){this.calls={}}var f=h.Define,e=h.opentag.Utils;a.prototype.on=function(a,
b){this.calls[a]||(this.calls[a]=[]);return e.addToArrayIfNotExist(this.calls[a],b)};a.prototype.call=function(a,b){var c=this.calls[a];if(c)for(var e=0;e<c.length;e++)try{c[e](b)}catch(f){}};a.prototype.remove=function(a,b){return this.calls[a]?e.removeFromArray(this.calls[a],b):null};a.prototype.removeAll=function(a){var b=0,c;for(c in this.calls)this.calls.hasOwnProperty(c)&&(b+=e.removeFromArray(this.calls[c],a));return b};a.prototype.clear=function(){this.calls={}};f.clazz("qubit.Events",a)})();
(function(){function a(a){this.log=new l("",function(){return this.CLASS_NAME+"["+this.config.name+"]"}.bind(this),"collectLogs");this.runCounter=this.urlsFailed=this.urlsLoaded=0;this.events=new h.Events({});this._depLoadedHandler=function(){this.dependenciesLoaded()&&this.awaitingDependencies&&this._triggerLoadingAndExecution()}.bind(this);this.config={name:"Tag-"+k++,async:!0,usesDocumentWrite:!1,timeout:this.LOADING_TIMEOUT,dependencies:[],url:null,urlLocation:null,locationPlaceHolder:"END",locationObject:null,
dontWaitForInjectionLocation:!1,noMultipleLoad:!1,loadDependenciesOnLoad:!1};this.delayDocWrite=!1;this.dependencies=[];this._lockObject={count:0};this._lockObjectDepsLoaded={};this.genericDependencies=[];if(a){if(!a.name){var b="Tag-"+k++;this.config.name=b}this.addState("INITIAL");for(var c in a)this.config[c]=a[c];a.genericDependencies&&(this.genericDependencies=this.genericDependencies.concat(a.genericDependencies));a.dependencies&&(this.dependencies=a.dependencies.concat(this.dependencies));
a.PACKAGE&&(this._package=a.PACKAGE);this.onInit()}}function f(){if(this.cancelled)this._handleCancel();else{this.waitForDependenciesFinished=(new Date).valueOf();var a=this._fullBodyNeededAndUnLoaded(),b=this._bodyNeededButNotAvailable();a||b?this.waitForDependenciesFinished=!1:(this.timeoutCountdownStart||(this.timeoutCountdownStart=(new Date).valueOf()),this.allDependenciesLoaded()?this._markLoadedSuccesfuly():this._loadingOutOfTimeFrames()?(this.loadingTimedOut=(new Date).valueOf(),this.allDependenciesLoaded(!0)?
this._markLoadedSuccesfuly():(this.addState("TIMED_OUT"),this._markLoadingDependenciesFailed(),this._triggerOnLoadTimeout())):this.waitForDependenciesFinished=!1);this.waitForDependenciesFinished?this.addState("LOADED_DEPENDENCIES"):this._setTimeout(f.bind(this),65)}}var e=h.opentag.Utils,d=h.opentag.TagsUtils,b=h.opentag.Timed,c=h.opentag.TagHelper,k=0,l=h.opentag.Log;h.Define.clazz("qubit.opentag.GenericLoader",a);a.prototype.onInit=x;a.prototype.LOADING_TIMEOUT=5E3;a.prototype.getHtml=function(){return this.config.html?
this.config.html:this.htmlContent?e.trim(this.htmlContent):null};a.prototype._executeScript=function(){var a=!1;try{this.script(),a=!0}catch(b){this.addState("EXECUTED_WITH_ERRORS"),this.executedWithErrors=(new Date).valueOf(),this._onError(b)}finally{this._onExecute(a)}};a.prototype.getTimeout=function(){return this._getTimeout()};a.prototype._getTimeout=function(a){var b=+this.config.timeout,c=this.dependencies;if(-1!==b&&0<c.length){var d=0;a=a||[];if(-1===e.indexInArray(a,this)){a[a.length]=this;
for(var k=0;k<c.length;k++){var m=c[k]._getTimeout(a);m>d&&(d=m)}0<d&&(b+=d)}else return 0}return b};a.prototype._onExecute=function(a){this.onExecute(a)};a.prototype.onExecute=x;a.prototype._flushDocWrites=function(a){var b=!0;this._docWriteNotFlushed=!1;try{var c=d.getHTMLLocationForTag(this);c&&this._securedWrites&&0<this._securedWrites.length&&((b=d.flushDocWritesArray(this._securedWrites,c,"END"===this.config.locationPlaceHolder,this.log,a))?this._docWriteFlushed=(new Date).valueOf():this._docWriteNotFlushed=
(new Date).valueOf())}catch(e){this._onError(e)}a&&a();this._securedWrites&&0<this._securedWrites.length&&(b=!1,this._docWriteNotFlushed=(new Date).valueOf());return b};a.prototype.log=x;a.prototype.finished=function(){return!!this.runIsFinished};a.prototype.script=function(){};a.prototype.before=function(){this.beforeRun=(new Date).valueOf();try{this.events.call("before",this)}catch(a){this._onError(a)}};a.prototype.onBefore=function(a){this.events.on("before",a)};a.prototype.after=function(a){this.afterRun=
(new Date).valueOf();try{this.events.call("after",{success:a,tag:this})}catch(b){this._onError(b)}};a.prototype.onAfter=function(a){this.events.on("after",a)};a.prototype.runOnce=function(){this._runOnceTriggered||this.scriptExecuted||(this._runOnceTriggered=(new Date).valueOf(),this.run())};a.CANCEL_ALL=!1;a.prototype.run=function(){if(!isNaN(this.config.runningLimit)&&this.config.runningLimit<=this.runCounter)return!1;if(this.cancelled||a.CANCEL_ALL)return this._handleCancel(),!1;if(this.isRunning)return!1;
this.lastRun&&this.reset();this.lastRun=this.isRunning=(new Date).valueOf();this.runCounter++;this._ignoreDeps=!!this.ignoreDependencies;return this._ignoreDeps||this.dependenciesLoaded()?this._triggerLoadingAndExecution():(this._attachDepsEventsToContinue(),!1)};a.prototype._triggerLoadingAndExecution=function(){this.awaitingDependencies=-(new Date).valueOf();this.load();this._ignoreDeps?this.execute():this.waitForDependenciesAndExecute();return!0};a.prototype._attachDepsEventsToContinue=function(){this.awaitingDependencies=
(new Date).valueOf();for(var a=this.dependencies,b=0;b<a.length;b++)try{a[b].events.on("success",this._depLoadedHandler)}catch(c){}};a.prototype.dependenciesLoaded=function(){for(var a=this.dependencies,b=0;b<a.length;b++)if(a[b]!==this&&!(0<+a[b].scriptExecuted))return!1;return!0};a.prototype._setTimeout=function(a,c){this._wasTimed=(new Date).valueOf();return b.setTimeout(a,c)};a.prototype._handleCancel=function(){this.addState("CANCELLED");try{this.onCancel()}catch(a){this._onError(a)}};a.prototype.waitForDependenciesAndExecute=
function(){this.cancelled?this._handleCancel():this.loadedDependencies?this.execute():this.loadingDependenciesFailed?(this._markFailure(),this._markFinished()):this._setTimeout(this.waitForDependenciesAndExecute.bind(this),30)};a.prototype.execute=function(){this._triggerExecution()};a.prototype._triggerExecution=function(){if(this.cancelled)this._handleCancel();else if(!this.scriptExecuted){var a=!0;if(this.shouldWaitForDocWriteProtection())a=!1;else{if(!this._beforeEntered){this._beforeEntered=
(new Date).valueOf();a=!1;try{a=this.before()}catch(b){this._onError(b)}if(a){this._markFailure();this._markFinished();return}}a=this.loadExecutionURLsAndHTML(this._triggerExecution.bind(this))}if(!this.scriptExecuted)if(this.unexpectedFail&&(a=!0),a){this._flushDocWrites();this.scriptLoadingFailed||this.injectHTMLFailed||this.unexpectedFail?this._markFailure():(this.scriptExecuted=(new Date).valueOf(),this.addState("EXECUTED"),this._executeScript());if(this.cancelled)return this._handleCancel(),
!1;a=0<this.scriptExecuted;try{this.afterRun||(this.afterRun=(new Date).valueOf(),this.after(a))}catch(c){this.executedWithErrors=(new Date).valueOf()}this.executedWithErrors||a&&this.events.call("success");this._flushDocWrites();this._markFinished()}else this._setTimeout(this._triggerExecution.bind(this),30)}};a.prototype._markFailure=function(){this.scriptExecuted=-(new Date).valueOf();this.addState("FAILED_TO_EXECUTE")};a.prototype._markFinished=function(){this.runIsFinished=(new Date).valueOf();
this.isRunning=!1;a.LOCK_DOC_WRITE===this&&(this._flushDocWrites(),d.unlockDocumentWrites(),a.LOCK_DOC_WRITE=!1);this.onFinished(!0)};a.prototype.onFinished=x;a.prototype.onCancel=x;a.prototype.onFinished=x;a.prototype.shouldWaitForDocWriteProtection=function(){if(this.willSecureDocumentWrite())if(!a.LOCK_DOC_WRITE)a.LOCK_DOC_WRITE=this,this._secureWriteAndCollectForExecution();else if(a.LOCK_DOC_WRITE!==this)return this._lockedDocWriteInformed||(this._lockedDocWriteInformed=(new Date).valueOf()),
!0;return!1};a.prototype.runWithoutDependencies=function(){this.ignoreDependencies=!0;this.run()};a.prototype.loadExecutionURLsAndHTML=function(a){if(this.cancelled)return this._handleCancel(),!0;this._loadExecutionURLsAndHTMLInformed||(this._loadExecutionURLsAndHTMLInformed=!0);this._triggerURLsLoading(a);return this.loadURLsNotFinished||(this._flushDocWrites(),this._triggerHTMLInjection(),this._flushDocWrites(),this.injectHTMLNotFinished||(this._flushDocWrites(),this._docWriteNotFlushed))?!1:!0};
a.prototype._triggerURLsLoading=function(a){!this._urlLoadTriggered&&this.config.url&&(this._urlLoadTriggered=!0,this.loadURLs(!1,a))};a.prototype._triggerHTMLInjection=function(){!this._injectHTMLTriggered&&this.getHtml()&&(this._injectHTMLTriggered=!0,this.injectHTML())};a.prototype.STATE={INITIAL:0,STARTED:1,LOADING_DEPENDENCIES:2,LOADED_DEPENDENCIES:4,LOADING_URL:8,LOADED_URL:16,EXECUTED:32,EXECUTED_WITH_ERRORS:64,FAILED_TO_LOAD_DEPENDENCIES:128,FAILED_TO_LOAD_URL:256,FAILED_TO_EXECUTE:512,TIMED_OUT:1024,
UNEXPECTED_FAIL:2048,CANCELLED:4096};a.prototype.addState=function(a){if(this.STATE.hasOwnProperty(a)){this.state|=this.STATE[a];try{this.onStateChange(a)}catch(b){this._onError(b)}}};a.prototype.onStateChange=x;a.prototype.cancel=function(){this.cancelled=(new Date).valueOf()};a.prototype.unCancel=function(){this.cancelled=void 0};a.prototype.state=a.prototype.STATE.INITIAL;a.prototype._markLoadedSuccesfuly=function(){this.loadedDependencies=(new Date).valueOf();this.onAllDependenciesLoaded()};a.prototype._secureWriteAndCollectForExecution=
function(){this._securedWrites||(this._securedWrites=[],d.redirectDocumentWritesToArray(this._securedWrites,this.log))};a.prototype._markLoadingDependenciesFailed=function(){this.addState("FAILED_TO_LOAD_DEPENDENCIES");this.loadingDependenciesFailed=(new Date).valueOf()};a.prototype.allDependenciesLoaded=function(a,b){return 0===this.getDependenciesToBeLoaded(a,b).length};a.prototype.getDependenciesToBeLoaded=function(a,b){var c=b||[];this.injectionLocationReady()||c.push("injection location");var d,
e=this.dependencies;for(d=0;d<e.length;d++)e[d]!==this&&(0<+e[d].scriptExecuted||c.push("dependant Tag with name -> "+(e[d].config?e[d].config.name:"anonymous")));for(d=0;d<this.genericDependencies.length;d++)this.genericDependencies[d](this)||c.push("this.genericDependencies["+d+"] (index: "+d+")");return c};a.prototype.docWriteAsksToWaitForBody=function(){return!(!this.delayDocWrite||!this.config.usesDocumentWrite)};a.prototype._bodyNeededButNotAvailable=function(){return this._dontWaitForInjections()?
!1:this._isBodyLocationNeeded()&&!d.bodyAvailable()};a.prototype._isBodyLocationNeeded=function(){return this.isLoadingAsynchronously()?this._isBodyLocationSet()?!0:"HEAD"===this.config.locationObject&&"END"===this.config.locationPlaceHolder:!1};a.prototype._isBodyLocationSet=function(){var a=this.config.locationObject;return!a||"BODY"===a};a.prototype._fullBodyNeededAndUnLoaded=function(){if(this._dontWaitForInjections())return!1;var a=!1;this._isBodyLocationNeeded()&&(a="END"===this.config.locationPlaceHolder);
return(a=a||this.fullbodyNeeded||this.docWriteAsksToWaitForBody())&&!e.bodyReady()};a.prototype._dontWaitForInjections=function(){return this.config.dontWaitForInjectionLocation||this.dontWaitForInjectionLocation||a.dontWaitForInjectionLocation};a.prototype.injectionLocationReady=function(){return this._dontWaitForInjections()?!0:this._fullBodyNeededAndUnLoaded()?!1:this.isLoadingAsynchronously()?!!d.getHTMLLocationForTag(this):!0};a.prototype._loadingOutOfTimeFrames=function(){return 0>this.getTimeout()?
!1:(new Date).valueOf()-this.timeoutCountdownStart>this.getTimeout()};a.prototype.loadDependencies=function(){this._loadDependencies()};a.prototype.addClientDependenciesList=function(a,b){return this.addDependenciesList(a,h.Define.clientSpaceClasspath())};a.prototype.addDependenciesList=function(b,c){if(b&&0!==b.length){this.failedDependenciesToParse||(this.failedDependenciesToParse=[]);for(var d=this.dependencies,k=0;k<b.length;k++){var f=b[k],m=!1;if(f instanceof a)d.push(f);else if("string"===
typeof f){var n=f;c&&(f=c+"."+f);var s=e.getObjectUsingPath(f);s?s instanceof a?d.push(s):m=!0:this.failedDependenciesToParse.push(n)}else m=!0;m&&(this.badDepsObjects=this.badDepsObjects||[],e.addToArrayIfNotExist(this.badDepsObjects,f))}}};a.prototype._loadDependencies=function(a){a=a||[];var b=this.dependencies;if(-1===e.indexInArray(a,this)){a[a.length]=this;for(var c=0;c<b.length;c++)b[c].load(a)}};a.prototype.onError=x;a.prototype._onError=function(a){try{this.onError(a)}catch(b){}};a.prototype._triggerOnLoadTimeout=
function(){this.onLoadTimeout()};a.prototype.onLoadTimeout=x;a.prototype.onScriptsLoadSuccess=x;a.prototype.onScriptLoadError=x;a.prototype.onAllDependenciesLoaded=x;a.prototype.onBeforeLoad=null;a.prototype.load=function(){if(!this.loadStarted){this.loadStarted=(new Date).valueOf();try{if(this.onBeforeLoad)this.onBeforeLoad()}catch(a){this._onError(a)}this.addState("LOADING_DEPENDENCIES");try{!this._ignoreDeps&&this.config.loadDependenciesOnLoad&&this.loadDependencies()}catch(b){throw b;}f.call(this)}};
a.prototype._singleUrlLoadHandler=function(a,b,c){++this.urlsLoaded;a||++this.urlsFailed;if(this.urlsLoaded===b.length)if(this.loadURLsNotFinished=!1,a&&0===this.urlsFailed){this.addState("LOADED_URL");this.urlsLoaded=(new Date).valueOf();try{c&&c(!0)}catch(d){this._onError(d)}finally{this.onScriptsLoadSuccess()}}else{a="error loading urls. Failed "+this.urlsFailed;this._onError(a);this.addState("FAILED_TO_LOAD_URL");this.urlsLoaded=-(new Date).valueOf();try{this.scriptLoadingFailed=!0,c&&c(!1)}catch(e){this._onError(e)}finally{this.onScriptLoadError(a)}}};
a.prototype.loadURLs=function(a,b){var c=a||this.config.url;this.addState("LOADING_URL");try{!c||c instanceof Array||(c=[c]);for(var d=0;d<c.length;d++){this.loadURLsNotFinished=!0;var e=c[d],e=this.prepareURL(e);this.loadURL(e,function(a){this._singleUrlLoadHandler(a,c,b)}.bind(this))}}catch(m){this.loadURLsNotFinished=!1,this.addState("UNEXPECTED_FAIL"),this.unexpectedFail=(new Date).valueOf(),this._onError(m)}};a.prototype.prepareLocationObject=function(a){return a};a.prototype.prepareURL=function(a){return a};
a.prototype.prepareHTML=function(a){return a};a.prototype.loadURL=function(a,b,c){this.addState("LOADING_URL");d.loadScript({onsuccess:function(){try{b&&b(!0)}catch(a){}}.bind(this),onerror:function(){try{b&&b(!1)}catch(a){}}.bind(this),url:a,node:c||this.config.urlLocation,async:this.isLoadingAsynchronously(),noMultipleLoad:this.config.noMultipleLoad})};a.prototype.reset=function(){this._securedWrites=this.delayDocWrite=this.scriptLoadingFailed=this.scriptExecuted=this.runIsFinished=this.loadingTimedOut=
this.loadingDependenciesFailed=this.loadedDependencies=this.loadURLsNotFinished=this.loadStarted=this.injectHTMLFailed=this.filtersRunTriggered=this.beforeRun=this.afterRun=this._urlLoadTriggered=this._runOnceTriggered=this._lockedDocWriteInformed=this._loadExecutionURLsAndHTMLInformed=this._injectHTMLTriggered=void 0;this.state=0;this.unexpectedFail=void 0;this.urlsLoaded=this.urlsFailed=0;this.timeoutCountdownStart=this.awaitingDependencies=this._beforeEntered=this.cancelled=this._lastRun=this.isRunning=
this.waitForDependenciesFinished=void 0;this.addState("INITIAL")};a.prototype.isLoadingAsynchronously=function(){return this._wasTimed?!0:!(!this.config.async&&!this.forceAsynchronous)};a.prototype.willSecureDocumentWrite=function(){return this.config.usesDocumentWrite&&this.isLoadingAsynchronously()};a.prototype.injectHTML=function(a){var b=!this.docWriteAsksToWaitForBody(),d=this.prepareHTML(this.getHtml());d&&c.injectHTMLForLoader(this,a,b,d)};a.prototype.clone=function(){return new a(this.config)}})();
(function(){function a(b){e.setIfUnset(b,{filterTimeout:b&&b.filterTimeout||this.FILTER_WAIT_TIMEOUT,PACKAGE:b&&b.PACKAGE,dedupe:!1,needsConsent:!1,inactive:!1,variables:null,runner:null,disabled:!1,locked:!1,reRunOnVariableChange:!1});a.SUPER.apply(this,arguments);this.namedVariables={};this.parameters=[];this.filters=[];this.session=null;this.pingSent=!1;this.reRunCounter=0;if(b){this.addState("INITIAL");try{a.register(this)}catch(c){}this.setupConfig(b);this.uniqueRefString=null;if(b.init)try{b.init.call(this,
b)}catch(d){}this.onTagInit();this.handleVariableChange=this._handleVariableChange.bind(this)}}function f(a,b){var d=a.namedVariables,e=c.initPageVariable(d[b]);return d[b]=e}var e=h.opentag.Utils,d=h.opentag.TagsUtils,b=h.opentag.filter.BaseFilter,c=h.opentag.TagHelper,k=h.opentag.pagevariable.BaseVariable,l=h.Cookie,g=h.Define;g.clazz("qubit.opentag.BaseTag",a,h.opentag.GenericLoader);a.prototype.setupConfig=function(a){if(a){a.filters&&this.addFilters(a.filters);a.parameters&&this.addParameters(a.parameters);
if(a.variables)for(var b in a.variables)if(a.variables.hasOwnProperty(b)){var c=this.getParameterByTokenName(b);if(c){var d=a.variables[b];c.variable=d;void 0!==d.defaultValue&&(c.defaultValue=d.defaultValue);void 0!==d.uv&&(c.uv=d.uv)}}a.locked&&this.lock()}};a.prototype.valueForToken=function(a,b){var c=this.getParameterByTokenName(a);if(c)return void 0===b&&this.loadingTimedOut&&(b=!0),this.getParameterValue(c,b);if((c=this.namedVariables)&&c[a]&&(c=f(this,a)))return c.getRelativeValue(b)};a.prototype.addParameters=
function(a){this.parameters=this.parameters.concat(a)};a.prototype.LOADING_TIMEOUT=5E3;a.prototype.FILTER_WAIT_TIMEOUT=-1;a.prototype._isVariable=function(a){return null!==a&&void 0!==a};a.prototype.run=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();var a=this.parameters;if(a)for(var b=0;b<a.length;b++){var c=this.getVariableForParameter(a[b]);if(!this._isVariable(c)){this._markLoadingDependenciesFailed();this._markFinished();return}}if(this.config.runner){a=!1;
try{this.addState("AWAITING_CALLBACK"),a=this._runner=(new Date).valueOf(),this.config.runner.call(this)}catch(d){}return a}this._runner=!1;return this.start()};a.prototype.lock=function(){this.locked=!0;this._unlock=null};a.prototype.unlock=function(){this.locked=!1;this._unlock&&(this._unlock(),this._unlock=!1)};a.prototype.start=function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.run.call(this)}.bind(this),!1):a.SUPER.prototype.run.call(this)};a.prototype.startOnce=
function(){return this.locked?(this._unlock=function(){return a.SUPER.prototype.runOnce.call(this)}.bind(this),!1):a.SUPER.prototype.runOnce.call(this)};a.prototype.getFilters=function(){return this.filters};a.prototype.runOnceIfFiltersPass=function(){this._runOnceIfFiltersPassTriggered||this.scriptExecuted||(this._runOnceIfFiltersPassTriggered=(new Date).valueOf(),this.runIfFiltersPass())};a.prototype.runIfFiltersPass=function(){if(this.destroyed)throw"Tag is destroyed.";this.resolveAllDynamicData();
var a=this.filtersState(!0);this.addState("FILTER_ACTIVE");this.filtersRunTriggered||(this.filtersRunTriggered=(new Date).valueOf());if(a===b.state.SESSION)this.addState("AWAITING_CALLBACK"),this.awaitingCallback=(new Date).valueOf();else if(a===b.state.PASS){this.filtersPassed=(new Date).valueOf();try{this.onFiltersPassed()}catch(c){}this.run()}else if(a===b.state.FAIL)this._markFiltersFailed(),this._markFinished();else if(0<a){var d=this.config.filterTimeout;if(0>d||(new Date).valueOf()-this.filtersRunTriggered>
d){if(!this._awaitingForFilterInformed){this._awaitingForFilterInformed=(new Date).valueOf();try{this.onFiltersDelayed()}catch(e){}}this._setTimeout(this.runIfFiltersPass.bind(this),a)}else this._markFiltersFailed(),this._markFinished(),this.filtersRunTimedOut=(new Date).valueOf()}try{this.onFiltersCheck(a)}catch(k){}return a};a.prototype._markFiltersFailed=function(){this.addState("FILTERS_FAILED");this.filtersPassed=-(new Date).valueOf()};a.prototype.STATE={INITIAL:0,FILTER_ACTIVE:1,AWAITING_CALLBACK:2,
FILTERS_FAILED:4,STARTED:8,LOADING_DEPENDENCIES:16,LOADED_DEPENDENCIES:32,LOADING_URL:64,LOADED_URL:128,EXECUTED:256,EXECUTED_WITH_ERRORS:512,FAILED_TO_LOAD_DEPENDENCIES:1024,FAILED_TO_LOAD_URL:2048,FAILED_TO_EXECUTE:4096,TIMED_OUT:8192,UNEXPECTED_FAIL:16384,CANCELLED:32768};a.prototype.addState=function(b){a.SUPER.prototype.addState.call(this,b);try{a.onStateChange(this)}catch(c){}this.stateStack=[];b=this.STATE;var d=this.state,e=this.stateStack;d&b.INITIAL&&e.push("Initial state.");d&b.FILTER_ACTIVE&&
e.push("Tag running with filters pass triggered.");d&b.FILTERS_FAILED&&e.push("Filters failed to pass.");d&b.AWAITING_CALLBACK&&e.push("Awaiting callback to run this tag. Not pooling.");d&b.STARTED&&e.push("Tag is initialized and loading has been started.");d&b.LOADING_DEPENDENCIES&&e.push("Dependencies are being loaded.");d&b.LOADED_DEPENDENCIES&&e.push("Dependencies loading process has been finished.");d&b.LOADING_URL&&e.push("External URL is being loaded.");d&b.LOADED_URL&&e.push("External URL has been loaded.");
d&b.EXECUTED&&e.push("Main script has been executed.");d&b.EXECUTED_WITH_ERRORS&&e.push("Main script has been executed but errors occured.");d&b.FAILED_TO_LOAD_DEPENDENCIES&&e.push("Dependencies has failed to load.");d&b.FAILED_TO_LOAD_URL&&e.push("URL location failed to load.");d&b.FAILED_TO_EXECUTE&&e.push("Script failed to execute.");d&b.TIMED_OUT&&e.push("Script timed out awaiting for dependencies.");d&b.UNEXPECTED_FAIL&&e.push("Script occured UNEXPECTED exception and is failed.");d&b.CANCELLED&&
e.push("Tag has been cancelled.")};a.prototype.onTagInit=x;a.onStateChange=x;a.prototype.onFiltersDelayed=x;a.prototype.onFiltersPassed=x;a.prototype.onFiltersCheck=x;a.prototype.state=a.prototype.STATE.INITIAL;a.prototype.arePageVariablesLoaded=function(a){return c.allParameterVariablesReadyForTag(this,a)};a.prototype.getDependenciesToBeLoaded=function(b,c){var d=c||[];this.arePageVariablesLoaded(b)||d.push("page variables");return a.SUPER.prototype.getDependenciesToBeLoaded.call(this,b,d)};a.prototype.resolveAllDynamicData=
function(){this.resolvePageVariables();this.resolveDependencies();this.resolveFilters()};a.prototype.resolveDependencies=function(){var a=this.failedDependenciesToParse;a&&(this.failedDependenciesToParse=null,this.addDependenciesList(a,g.clientSpaceClasspath()));return this.dependencies};a.prototype.addClientVariablesMap=function(a){return this.unresolvedClientVariablesMap=this._addVariablesMap(a,g.clientSpaceClasspath())};a.prototype.resolvePageVariables=function(){var a=this.unresolvedClientVariablesMap;
a&&(this.unresolvedClientVariablesMap=null,this.addClientVariablesMap(a));if(a=this.unresolvedVariablesMap)this.unresolvedVariablesMap=null,this.addVariablesMap(a);return this.getPageVariables()};a.prototype.addVariablesMap=function(a){return this.unresolvedVariablesMap=this._addVariablesMap(a)};a.prototype._addVariablesMap=function(a,b){if(a){var c={},d=this.namedVariables,g;for(g in a)if(a.hasOwnProperty(g)){var f=a[g];if(f instanceof k)d[g]=f;else if("string"===typeof f){var l=f;b&&(f=b+"."+f);
var h=e.getObjectUsingPath(f);h?d[g]=h instanceof k?h:f:c[g]=l}}return c}};a.prototype.prepareURL=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareLocationObject=function(a){return this.replaceTokensWithValues(a)};a.prototype.prepareHTML=function(a){a&&(a=this.replaceTokensWithValues(a));return a};a.prototype._executeScript=function(){if(this.config&&this.config.script)if("function"===typeof this.config.script)this.script=this.config.script;else{var b=this.replaceTokensWithValues(String(this.config.script));
this.script=e.expressionToFunction(b).bind(this)}a.SUPER.prototype._executeScript.call(this)};a.prototype.replaceTokensWithValues=function(a){if(!a||-1===a.indexOf("${"))return a;var b=this.parameters;if(b)for(var c=0;c<b.length;c++){var d=this.getVariableForParameter(b[c]);if(d){var e=b[c].token,k=this.valueForToken(e);a=d.replaceToken(e,a,k)}}return a};a.prototype.getParameter=function(a){var b=this.parameters,c=null;if(b)for(var d=0;d<b.length;d++)b[d].name===a&&(c=b[d]);return c};a.prototype.setParameterValueByTokenName=
function(a,b){var c=this.getParameterByTokenName(a);return null!==c?(c.variable={value:b},!0):!1};a.prototype.getParameterValue=function(a,b){var c="string"===typeof a?this.getParameter(a):a;if(c){var d=this.getVariableForParameter(c);if(d)try{var k;b&&""!==c.defaultValue&&(k=e.gevalAndReturn(c.defaultValue).result);return k=d.getRelativeValue(b,k)}catch(g){}}};a.prototype.filtersState=function(a){return d.filtersState(this.filters,this.session,this,a)};a.prototype.addFilter=function(a){e.addToArrayIfNotExist(this.filters,
a)};a.prototype.addFilters=function(a){for(var b=0;b<a.length;b++)this.addFilter(a[b])};a.prototype.addClientFiltersList=function(a){return this.unresolvedClientFilterClasspaths=this.addFiltersList(a,g.clientSpaceClasspath())};a.prototype.resolveFilters=function(){var a=this.unresolvedClientFilterClasspaths;a&&(this.unresolvedClientFilterClasspaths=null,this.addClientFiltersList(a));return this.filters};a.prototype.addFiltersList=function(a,c){for(var d=[],k=0;k<a.length;k++)try{var g=a[k],f=null;
"string"===typeof g&&(f=g,c&&(g=c+"."+g),g=e.getObjectUsingPath(g));"function"===typeof g&&(g=new g);!g instanceof b&&(g=null);g?this.addFilter(g):f&&e.addToArrayIfNotExist(d,f)}catch(l){this.failedFilters=this.failedFilters||[],this.failedFilters.push(a[k])}return d};a.prototype.reset=function(){a.SUPER.prototype.reset.call(this);this.dedupePingSent=this.filtersPassed=void 0;this.pingSent=!1;this._runner=this.filtersRunTriggered=this._runOnceIfFiltersPassTriggered=void 0;this.reRunCounter=0;this.detachVariablesChangedListeners()};
a.prototype.resetFilters=function(){for(var a=0;a<this.filters.length;a++)this.filters[a].reset()};a.prototype.getParameterByTokenName=function(a){var b=null;if(this.parameters)for(var c=this.parameters,d=0;d<c.length;d++)c[d].token===a&&(b=c[d]);return b};a.prototype.removeFilter=function(a){e.removeFromArray(this.filters,a)};var p=0,r=[],q={},v={};a.register=function(a){var b=e.addToArrayIfNotExist(r,a);a._tagIndex=-1===b?r.length-1:b;a.config.id?(b="Q"+a.config.id,v[b]=a,a.uniqueId=b):v[a.CLASSPATH]=
a};a.getById=function(a){return v[String(a)]};a.prototype.getById=a.getById;a.prototype.unregister=function(b){a.unregister(b||this)};a.prototype.destroy=function(){this.destroyed=!0;this.cancel();a.unregister(this)};a.unregister=function(a){e.removeFromArray(r,a);a._tagIndex=-1};a.getTags=function(){return r};a.getAccessorsMap=function(){return q};a.prototype.getTags=function(){return r};a.prototype.getPageVariables=function(){var a=this.parameters,b=[];if(a)for(var c=0;c<a.length;c++){var d=this.getVariableForParameter(a[c]);
this._isVariable(d)&&e.addToArrayIfNotExist(b,d)}if(this.namedVariables)for(var k in this.namedVariables)e.addToArrayIfNotExist(b,f(this,k));return b};a.prototype.getAccessorString=function(){this._accessorsMapKey||(this._accessorsMapKey="_"+p++,q[this._accessorsMapKey]=this);return"qubit.opentag.BaseTag.getAccessorsMap()."+this._accessorsMapKey};a.prototype.getVariableForParameter=function(a){var b,d=this.namedVariables;d&&d[a.token]&&(b=f(this,a.token));b||(b=c.validateAndGetVariableForParameter(a));
return b};a.prototype.printVariablesState=function(){for(var a=[],b=c.getAllVariablesWithParameters(this),d=0;d<b.length;d++){var e=b[d].parameter,k=b[d].variable,g;g=e&&e.token?this.valueForToken(e.token):k.getRelativeValue(!0);e={name:k.config.name,exists:k.exists(),token:e?e.token:null,value:g,variable:k};a.push(e)}return a};a.prototype._triggerOnLoadTimeout=function(){this.onLoadTimeout()};a.prototype.getId=function(){return this._getUniqueId()};a.prototype._getUniqueId=function(){return this.config.id?
this.config.id:0===String(this.CLASSPATH).indexOf(g.STANDARD_CS_NS)?this.CLASSPATH.substring(g.STANDARD_CS_NS.length+1):this.CLASSPATH+"#"+this.config.name};a.prototype.cookieSaysToRunEvenIfDisabled=function(){var a=this._getUniqueId(),b=!!l.get("qubit.tag.forceAllToRun");b||(b=!!l.get("qubit.tag.forceRunning_"+a));return b};a.prototype.setCookieForcingTagToRun=function(){var a=this._getUniqueId();l.set("qubit.tag.forceRunning_"+a,"true")};a.setCookieForcingTagsToRun=function(){l.set("qubit.tag.forceAllToRun",
"true")};a.prototype.setCookieToDisable=function(){var a=this._getUniqueId();l.set("qubit.tag.disableRunning_"+a,"true")};a.prototype.rmCookieToDisable=function(){var a=this._getUniqueId();l.rm("qubit.tag.disableRunning_"+a)};a.prototype.disabledByCookie=function(){var a=this._getUniqueId();return!!l.get("qubit.tag.disableRunning_"+a)};a.rmCookieForcingTagsToRun=function(){l.rm("qubit.tag.forceAllToRun")};a.prototype.rmCookieForcingTagToRun=function(){var a=this._getUniqueId();l.rm("qubit.tag.forceRunning_"+
a)};a.rmAllDisablingCookies=function(){e.rmCookiesMatching("qubit.tag.disableRunning_")};a.rmAllCookiesForcingTagToRun=function(){e.rmCookiesMatching("qubit.tag.forceRunning_");a.rmCookieForcingTagsToRun()};a.prototype.onVariableChanged=function(a){this.attachVariablesChangedListeners(!0);this.events.on("variableChanged",a)};a.prototype._handleVariableChange=function(a){this.events.call("variableChanged",a);this.isRunning||!this.config.reRunOnVariableChange||!isNaN(this.config.reRunLimit)&&this.config.reRunLimit<=
this.reRunCounter||(a=this.reRunCounter+1,this.reset(),this.reRunCounter=a,this.resetFilters(),this.runIfFiltersPass())};a.prototype.attachVariablesChangedListeners=function(a){var b=this.getPageVariables();if(a=!!(this.config.reRunOnVariableChange||this.config.observeVariables||a))for(var c=0;c<b.length;c++)b[c].onValueChanged(this.handleVariableChange,a)};a.prototype.detachVariablesChangedListeners=function(){for(var a=this.getPageVariables(),b=0;b<a.length;b++)a[b].deatchOnValueChanged(this.handleVariableChange)};
a.prototype._markFinished=function(){a.SUPER.prototype._markFinished.call(this);this.attachVariablesChangedListeners()}})();(function(){var a=h.opentag.Utils,f=h.opentag.filter.BaseFilter,e=function(){};h.Define.clazz("qubit.opentag.Tags",e);e.getById=function(a){return h.opentag.BaseTag.getById(String(a))};e.getAllTagsByState=function(){return h.opentag.Container.getAllTagsByState(e.getTags())};e.findTagByName=function(a){for(var c=this.getTags(),d=[],e=0;e<c.length;e++)c[e].config.name===a&&d.push(c[e]);
return d};e.findTagByMatch=function(a){for(var c=this.getTags(),d=[],e=0;e<c.length;e++)c[e].config.name.match(a)&&d.push(c[e]);return d};e.findTagContainers=function(a){for(var c=e.getContainers(),d=[],f=0;f<c.length;f++){var g=c[f].tags,h;for(h in g)if(g[h]===a){d.push(c[f]);break}}return d};e.getTags=function(){return h.opentag.BaseTag.getTags()};e.resetAllTags=function(a){for(var c=e.getTags(),d=0;d<c.length;d++)c[d].reset(),a||c[d].resetFilters()};e.getContainersPageVariables=function(){for(var a=
e.getContainers(),c=[],d=0;d<a.length;d++)c=c.concat(a.getPageVariables());return c};e.getAllPageVariables=function(){for(var a=e.getTags(),c=[],d=0;d<a.length;d++)c=c.concat(a[d].getPageVariables());return c};e.cancelAll=function(){for(var a=e.getTags(),c=0;c<a.length;c++)a[c].cancel()};e.resetAll=function(a){for(var c=e.getTags(),d=0;d<c.length;d++)c[d].reset(),a||c[d].resetFilters()};e.getPageVariableByName=function(a){for(var c=e.getAllPageVariables(),d=[],f=0;f<c.length;f++)c[f].config.name===
a&&d.push(c[f]);return d};e.getLoadTime=function(a){var c=a.beforeRun,d=a.runIsFinished;return isNaN(d)?{tag:a,loadTime:null}:{tag:a,loadTime:d-c}};e.getLoadTimes=function(a){var c=[];if(a instanceof h.opentag.BaseTag)return c.push([e.getLoadTime(a[d])]),c;a=a||e.getTags();if(a instanceof Array)for(d=0;d<a.length;d++)a[d]instanceof h.opentag.BaseTag&&c.push(e.getLoadTime(a[d]));else for(var d in a)a[d]instanceof h.opentag.BaseTag&&c.push(e.getLoadTime(a[d]));return c};e.forceAllContainersAndTagsToRunIfDisabled=
function(){h.opentag.Container.setCookieForDisabledContainersToRun();h.opentag.BaseTag.setCookieForcingTagsToRun()};e.rmAllContainersAndTagsForcingFlags=function(){h.opentag.Container.rmCookieForDisabledContainersToRun();h.opentag.BaseTag.rmAllCookiesForcingTagToRun()};e.getContainers=function(){return h.opentag.Container.getContainers()};e.findAllTagsByClassPath=function(b){var c=[],d=[];try{d.push(h.opentag.CustomTag),d.push(h.opentag.LibraryTag)}catch(f){}for(var g=e.getTags(),p=0;p<g.length;p++){var r=
g[p];0>a.indexInArray(d,r)&&0===r.PACKAGE_NAME.indexOf(b)&&c.push(r)}return c};e.findAllTags=function(a,c){var d=h.opentag.BaseTag,f=[];try{f.push(h.opentag.CustomTag),f.push(h.opentag.LibraryTag)}catch(g){}return e.findAllInstances(a,d,f,c)};var d=function(b,c,d,e){var g=[];"string"===typeof b&&(b=a.getObjectUsingPath(b));if(b){var f={objectsOnly:!0};e&&(f.maxDeep=!0);e=function(b,e,f,m){if(c(b)){for(e=0;e<d.length;e++)if(d[e]===b)return!0;a.addToArrayIfNotExist(g,b);return!0}return!1}.bind(this);
a.traverse(b,e,f)}return g};e.findAllInstances=function(a,c,e,f){return d(a,function(a){return a instanceof c},e,f)};e.findAllInheriting=function(a,c,e,f){return d(a,function(a){return a.prototype instanceof c},e,f)};e.findAllFilters=function(a,c){var d=[];try{d.push(h.opentag.filter.Filter),d.push(h.opentag.filter.URLFilter)}catch(l){}return e.findAllInheriting(a,f,d,c)}})();D={};A=void 0;D.update=function(){var a,f;f=function(){return Math.floor(1+65536*Math.random()).toString(36).substring(1)};
window.__pageViewId__||(a=(new Date).getTime().toString(36),window.__pageViewId__=a+f()+f()+f());return window.__pageViewId__};t.PostData=function(a,f,e){var d,b,c,k,l,g,h;h=2;l=!1;g=function(){0<h&&setTimeout(function(){l||(h-=1,d())},5E3)};b=navigator.userAgent.toLowerCase();c=-1!==b.indexOf("msie");b.indexOf("msie 9");b=-1!==b.indexOf("msie 7")||-1!==b.indexOf("msie 6");k=("https:"===document.location.protocol?"https:":"http:")+a;e=e||"POST";d=function(){var a;try{a=null;try{a=new XMLHttpRequest}catch(b){}a&&
!c?a.open(e,k,!0):"undefined"!==typeof XDomainRequest?(a=new XDomainRequest,a.open(e,k)):a=null;try{a.withCredentials=!1}catch(d){}a.setRequestHeader&&a.setRequestHeader("Content-Type","text/plain;charset=UTF-8");a.onload=function(){l=!0};a.onreadystatechange=function(){};a.ontimeout=function(){};a.onerror=function(){};a.onprogress=function(){};a.send(f)}catch(m){try{try{t.fileLoader.load(k)}catch(n){window.console&&window.console.log&&window.console.log(m)}}catch(s){}}g()};b?t.fileLoader.load(k):
d()};(function(){function a(){}h.Define.clazz("qubit.opentag.Ping",a);a.prototype.send=function(f,e){for(var d=f.config,b="c="+d.clientId+"&p="+f.getContainerId()+"&l="+d.tellLoadTimesProbability+"&pv="+D.update()+"&d=",c=[],k=0;k<e.length;k++){var l=e[k].tag,g=e[k].loadTime;if(null!==g&&!isNaN(g)){var h=a.getPingID(l);!l.pingSent&&h&&null!==g&&void 0!==h&&(c.push('"'+h+'":'+g),l.pingSent=!0)}}d.pingServerUrl&&0<c.length&&(b+=encodeURIComponent("{"+c.join(",")+"}"),t.PostData("//"+d.pingServerUrl+
"/tag2?"+b,null,"GET"))};a.prototype.sendErrors=function(a,e){};a.prototype.sendDedupe=function(f,e){for(var d=f.config,b="c="+d.clientId+"&p="+f.getContainerId()+"&l="+d.tellLoadTimesProbability+"&pv="+D.update()+"&dd=",c=[],k=0;k<e.length;k++){var h=e[k],g=a.getPingID(h);void 0===g||h.dedupePingSent||(c.push(g),h.dedupePingSent=!0)}0<c.length&&d.pingServerUrl&&(b+=encodeURIComponent("["+c.join(",")+"]"),t.PostData("//"+d.pingServerUrl+"/tag2?"+b,null,"GET"))};a.getPingID=function(a){if(a.config.id)return a.config.id;
var e=a.PACKAGE_NAME.lastIndexOf(".");return-1!==e?a.PACKAGE_NAME.substring(e+1):a.PACKAGE_NAME}})();A={_cookieName:"_qst_s",_sessionCookie:"_qsst_s",update:function(a){var f,e;f=h.Cookie.get(A._cookieName);e=h.Cookie.get(A._sessionCookie);if(f){if(f=parseInt(f,10),!e||parseInt(e,10)<(new Date).getTime()-18E5)f+=1}else f=1;h.Cookie.set(A._cookieName,f,365,a);h.Cookie.set(A._sessionCookie,(new Date).getTime().toString(),null,a);return f}};var z={};(function(){function a(a){return 10>a?"0"+a:a}function f(a){b.lastIndex=
0;return b.test(a)?'"'+a.replace(b,function(a){var b=h[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(b,d){var h,l,m,n,s=c,w,u=d[b];if(u instanceof Date)h=u,u=isFinite(h.valueOf())?h.getUTCFullYear()+"-"+a(h.getUTCMonth()+1)+"-"+a(h.getUTCDate())+"T"+a(h.getUTCHours())+":"+a(h.getUTCMinutes())+":"+a(h.getUTCSeconds())+"Z":null;else if(u instanceof String||u instanceof Number||u instanceof Boolean)u=u.valueOf();"function"===typeof g&&
(u=g.call(d,b,u));switch(typeof u){case "string":return f(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);case "object":if(!u)return"null";c+=k;w=[];if("[object Array]"===Object.prototype.toString.apply(u)){n=u.length;for(h=0;h<n;h+=1)try{w[h]=e(h,u)||"null"}catch(F){w[h]='{"stack_exceeded": null}'}m=0===w.length?"[]":c?"[\n"+c+w.join(",\n"+c)+"\n"+s+"]":"["+w.join(",")+"]";c=s;return m}if(g&&"object"===typeof g)for(n=g.length,h=0;h<n;h+=1){if("string"===
typeof g[h]){l=g[h];try{m=e(l,u)}catch(P){m='{"stack_exceeded": null}'}m&&w.push(f(l)+(c?": ":":")+m)}}else for(l in u)if(Object.prototype.hasOwnProperty.call(u,l)){try{m=e(l,u)}catch(t){m='{"stack_exceeded": null}'}m&&w.push(f(l)+(c?": ":":")+m)}m=0===w.length?"{}":c?"{\n"+c+w.join(",\n"+c)+"\n"+s+"}":"{"+w.join(",")+"}";c=s;return m}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
c,k,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},g;"function"!==typeof z.stringify&&(z.stringify=function(a,b,d){var f;k=c="";if("number"===typeof d)for(f=0;f<d;f+=1)k+=" ";else"string"===typeof d&&(k=d);if((g=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return e("",{"":a})});"function"!==typeof z.parse&&(z.parse=function(a,b){function c(a,d){var e,g,k=a[d];if(k&&"object"===typeof k)for(e in k)Object.prototype.hasOwnProperty.call(k,
e)&&(g=c(k,e),void 0!==g?k[e]=g:delete k[e]);return b.call(a,d,k)}var e;a=String(a);d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");})})();(function(){function a(a){if(a)if(a.alphabet)for(this.alphabet=
a.alphabet,this.dict={},a=0;a<this.alphabet.length;a++)this.dict[this.alphabet[a]]=a;else this.alphabet=e,this.dict=c}function f(a,b){for(var c in b)if(a===b[c])return c;return null}for(var e=[],d=Math.pow(2,8),b=0;b<d;b++)e.push(String.fromCharCode(b));for(var c={},d=0;d<e.length;d++)c[e[d]]=d;h.Define.clazz("qubit.compression.LZW",a);a.prototype.encode=function(a){for(var b=this.alphabet.length,c={},d=[],e=0,f=a.charAt(e++),h,m=this.dict;h=a.charAt(e++);){var n=f+h;if(m.hasOwnProperty(n)||c.hasOwnProperty(n))f=
n;else{var s=m.hasOwnProperty(f)?m[f]:c[f];if(void 0===s)throw"Dictionary base is to small for those contents: "+f;d.push(s);c[n]=b++;f=h}}""!==f&&d.push(c.hasOwnProperty(f)?c[f]:m[f]);return d};a.prototype.decode=function(a){for(var b=this.dict,c=this.alphabet.length,d,e={},h=f(a[0],b),v=h,m=[h],n=1;n<a.length;n++){var s=a[n];d=f(s,b);null===d&&(e.hasOwnProperty(s)&&(d=e[s]),null===d&&(d=v+h));m.push(d);h=d.charAt(0);e[c++]=v+h;v=d}return m.join("")}})();(function(){function a(a){}for(var f={},e=
0;45>e;e++)f["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(e)]=e;for(var d={},e=0;45>e;e++)d['ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(e)]=e;for(var b={},e=0;45>e;e++)b["abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(e)]='ABCDEFGHIJKLMNOPQRSTUVWXYZ*!-+()@{|}"]^_`~$&#'.charAt(e);var c="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".split(""),k=c.length,l=new h.compression.LZW({});h.Define.clazz("qubit.compression.Compressor",a);a.prototype.compress=function(a,b){for(var c=
(b||l).encode(a),d=[],e=0;e<c.length;e++)d.push(String.fromCharCode(c[e]));return d.join("")};a.prototype.compressAnsi=function(a,d){for(var e=(d||l).encode(a),f=[],h=0;h<e.length;h++){var m;m=e[h];var n=0,s=0>m;s&&(m=-m);var w="",u=!0;do n=m%k,u?(w=b[c[n]],u=!1):w=c[n]+w,m=(m-n)/k;while(0<m);m=s?"-"+w:w;f.push(m)}return f.join("")};a.prototype.decompressAnsi=function(a,b){for(var c=[],e="",h=0;h<a.length;h++){var m=a.charAt(h);if(d.hasOwnProperty(m)){for(var m=e+m,e="",n=0,s=0,w=!0,u=0;u<m.length;u++){var F=
m.charAt(m.length-1-u);w&&(w=!1,F="abcdefghijklmnopqrstuvwxyz0123456789'%./:<>?[".charAt(d[F]));n+=f[F]*Math.pow(k,s++)}m=n;c.push(m)}else e+=m}return(b||l).decode(c)};a.prototype.decompress=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a.charCodeAt(d));return(b||l).decode(c)}})();(function(){function a(a){for(var c=[],d=0;d<a.length;d++){var e=b(a[d][0]);c.push([new RegExp(e,"g"),"*"+a[d][1]])}return c}function f(a,b){for(var c=0;c<b.length;c++)if(b[c][1]===a)return b[c][0];return null}function e(b){this._regexDefs=
p;this._defs=g;b&&b.definitions&&(this._regexDefs=a(b.definitions),this._defs=b.definitions)}function d(a,b){for(var c=[],d=0;d<a.length;d++){var e=!0;b&&(e=a.charCodeAt(d)<=b);var f=l.cookieAlphabetMap.hasOwnProperty(a.charAt(d));e&&!f?c.push("*"+a.charCodeAt(d)+"."):c.push(a.charAt(d))}return c.join("")}function b(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function c(a){for(var b={},c="",d=0;d<a.length;d++){var e=a.charAt(d);r[e]?c+=e:(isNaN(b[c])&&(b[c]=a.split(c).length-1),c="")}a=
[];for(var f in b)b.hasOwnProperty(f)&&(c=b[f],c>=t&&f.length>=q&&a.push([f,c]));return a=a.sort(function(a,b){return a[0].length===b[0].length?0:b[0].length>a[0].length?1:-1})}var k=h.Define,l=h.Cookie,g=[['","referrer":[{"url":"http://',"1-"],['","referrer":[{"url":"https://',"2-"],[',"referrer":[{"url":"http://',"3-"],[',"referrer":[{"url":"https://',"4-"],[',"sessionStartTime":',"5-"],["www.google.co.uk","6-"],["www.google.","7-"],['"sessionStartTime":',"8-"],['"landing":"',"9-"],["http%3A%2F%2Fwww",
"10-"],['"landing":',"L"],['"time":',"A"],['"pageViews":',"P"],['"sessionCount":',"B"],['"referrer":',"R"],['"url":"http://www.',"J"],['"url":"https://www.',"M"],['"url":"',"I"],['"url":',"U"],["http://www.","W"],["https://www.","V"],["%2Fen%2Ftsuk%2F","K"],['"sessionLandingPage":',"F"],["http%3A%2F%2F","D"],["http://","H"],["https://","X"],['""',"O"],['",',"Y"],['":{}}',"z"],["<","S"],[">","G"],["[","Z"],["]","E"],["{","a"],["}","b"],["(","c"],[")","d"],["!","e"],["#","f"],["$","g"],["!","q"],["'",
"i"],[":","j"],["?","k"],["^","x"],["`","m"],["|","n"],["~","o"],["%","v"],[",","C"]],p=a(g);k.clazz("qubit.opentag.compression.Encoder",e);e.prototype.encode=function(a,e){for(var f=a.replace(/\*/g,"**"),k=c(f),g=0;g<this._regexDefs.length;g++)var h=this._regexDefs[g],f=f.replace(h[0],h[1]);f=f.replace(/;/g,"*-");f=f.replace(/&/g,"*.");f=f.replace(/\\/g,"*/");f=f.replace(/=/g,"*+");f=f.replace(/\n/g,"*N");f=f.replace(/ /g,"*_");f=f.replace(/\t/g,"*T");f=f.replace(/"/g,"*Q");g=c(f);g.concat(k);for(var k=
f.replace(/@/g,"@@"),h=[],l=0,p=0;l<g.length;l++){var q=new RegExp(b(g[l][0]),"g"),q=k.replace(q,"@"+p+"-");q!==k&&(h.push(g[l][0]),p++,k=q)}g=[k,h];k=g[1];(h=0<k.length)&&(f=g[0]);f=e?d(f,e):d(f);return h?"Y"+k.join("*")+"@"+f:"N"+f};for(var r={},k=0;65>k;k++)r["abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+_.".charAt(k)]=!0;var q=4,t=2;e.prototype.decode=function(a){var b=null;if("N"===a.charAt(0))a=a.substring(1);else if("Y"===a.charAt(0)){var c=a.indexOf("@");if(0<=c&&(b=a.substring(1,
c),b=b.split("*"),a=a.substring(c+1),b&&0!==b.length&&a)){for(var c="",d=!1,e=!1,k="",g=0;g<a.length;g++){var h=a.charAt(g);"@"===h||d||e?d||e?(d=!1,"@"===h?c+="@":isNaN(+("-"+h))?e?(c=b&&"-"===h&&b[+k]?c+b[+k]:c+("@"+k+h),k="",e=!1):c+="@"+h:(e=!0,k+=h)):d=!0:c+=h}k&&(c+="@"+k);d&&(c+="@");a=c}}b="";d=c=!1;e="";for(k=0;k<a.length;k++)g=a.charAt(k),"*"===g||c||d?c||d?(c=!1,isNaN(+("-"+g))?d?(b="."===g?b+String.fromCharCode(+e):"-"===g&&f(e+"-",this._defs)?b+f(e+"-",this._defs):b+("*"+e+g),e="",d=
!1):"*"===g?b+="*":"-"===g?b+=";":"/"===g?b+="\\":"."===g?b+="&":"+"===g?b+="=":"N"===g?b+="\n":"_"===g?b+=" ":"T"===g?b+="\t":"Q"===g?b+='"':null!==f(g,this._defs)?(g=f(g,this._defs),b+=g):b+="*"+g:(e+=g,d=!0)):c=!0:b+=g;e&&(b+="*"+e);c&&(b+="*");return b}})();(function(){function a(a){this.testBinary=!1;this.binSupported=e;a&&(this.compressor=new h.compression.Compressor,this.encoder=new h.opentag.compression.Encoder({}))}var f=h.Cookie,e=!1;h.Define.clazz("qubit.opentag.compression.CookieCompressor",
a);a.prototype.compress=function(a,b){if("string"!==typeof a||""===a)return a;var c=this.encoder.encode(a),e;if(this.binSupported||this.testBinary){e=this.compressor.compress(c);e='"B'+this.encoder.encode(e,128)+'"';f.set("__qtag_test_bin__",e,void 0,void 0,!0);var h=f.get("__qtag_test_bin__",!0);f.rm("__qtag_test_bin__");h&&h!==e&&(e=null)}h=this.encoder.encode(this.compressor.compressAnsi(c));c=!b&&c.length<=h.length?"E"+c:"C"+h;return e&&e.length<c.length?e:c};a.prototype.decompress=function(a){if("string"!==
typeof a||""===a)return a;'"'===a.charAt(0)&&(a=a.substring(1,a.length-1));var b=a.charAt(0);a=a.substring(1);switch(b){case "E":return this.encoder.decode(a);case "C":return a=this.compressor.decompressAnsi(this.encoder.decode(a)),this.encoder.decode(a);case "B":return a=this.compressor.decompress(this.encoder.decode(a)),this.encoder.decode(a);default:throw"This code is not supported! Code: "+b;}}})();(function(){var a=h.Cookie,f=h.opentag.Utils,e=function(){};h.Define.clazz("qubit.opentag.Session",
e);var d=new h.opentag.compression.CookieCompressor({});e.readCompressedCookie=function(b){b=a.get(b,!0);return d.decompress(b)};e.setupSession=function(b){var c=b.config,k,h,g,p,r;k={};k.sessionCount=A.update(c.cookieDomain);r="qtag_"+b.getContainerId();var q="x_qtag_"+b.getContainerId();g=a.get(r);b=!!g;null===g&&(g=a.get(q,!0),g=d.decompress(g));if(g)try{g=z.parse(g)}catch(t){g={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}else g={sc:0,sessionCount:0,
pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}};h=(new Date).getTime();k.sessionCount!==parseInt(g.sc,10)?(g.sessionStartTime=h,g.sc=k.sessionCount,g.sessionCount+=1,g.referrer.push({url:e.getReferrer(),landing:f.getUrl().substring(0,300),time:h}),g.sessionLandingPage=f.getUrl().substring(0,300)):e.isReferrerDifferent()&&!e.referrerIsSameAsPrevious(g.referrer,h,18E5)&&(g.referrer.push({url:e.getReferrer(),landing:f.getUrl().substring(0,300),time:h}),g.sessionLandingPage=f.getUrl().substring(0,
300),g.sessionStartTime=h,g.sessionCount+=1);k.sessionCount=g.sessionCount;k.sessionStartTime=g.sessionStartTime;k.pageStartTime=h;g.pageViews+=1;k.pageViews=g.pageViews;k.sessionLandingPage=g.sessionLandingPage;k.referrer=g.referrer;5<k.referrer.length&&k.referrer.splice(2,k.referrer.length-5);p=z.stringify(g);for(h=0;d.compress(p).length>c.maxCookieLength&&5>h;)3<=g.referrer.length?g.referrer.splice(2,1):2===g.referrer.length?g.referrer=[g.referrer[0]]:1===g.referrer.length&&(g.referrer=[]),p=z.stringify(g),
h+=1;k.referrer=g.referrer;b&&a.rm(r);r=d.compress(p);a.rm(q);0<c.maxCookieLength&&a.set(q,r,365,c.cookieDomain,!0);k.setVariable=function(b,e,f){g.__v[b]=[e,f?f:0];b=d.compress(z.stringify(g));0<c.maxCookieLength?a.set(q,b,365,c.cookieDomain,!0):a.rm(q)};k.getCookie=function(b,c){var e=a.get(b,!0);if(e&&(c||0===b.indexOf("x_")))try{e=d.decompress(e)}catch(f){}else null!==e&&(e=a.decode(e));return e};k.getVariable=function(a){var b;if(a=g.__v[a])if(b=a[1],0===b||b>(new Date).getTime())return a[0];
return null};k.on=function(a,b,c){b.attachEvent?b.attachEvent("on"+a,c):b.addEventListener&&b.addEventListener(a,c,!1)};k.getTagCookie=function(){return e.readCompressedCookie(q)};return e.lastSession=k};e.referrerIsSameAsPrevious=function(a,c,d){var h,g;return 0<a.length?(h=e.getReferrer(),g=f.getUrl().substring(0,300),a=a[a.length-1],a.url===h&&a.landing===g&&a.time+d>c):!1};e.isReferrerDifferent=function(){var a,c;c=e.getReferrer();a=c.indexOf("://");if(-1===a)return!0;try{return 0!==c.substring(a+
3).indexOf(e.getDomain())?!0:!1}catch(d){return!0}};e.getReferrer=function(){return document.referrer?document.referrer.substring(0,300):"direct"};e.getDomain=function(){return document.location.host}})();(function(){function a(b){e.setIfUnset(b,a.defaultConfig);if(this.singleton){var c=h.opentag.Utils.getObjectUsingPath(this.PACKAGE_NAME+"."+this.CLASS_NAME,B);if(c.__instance)return c.__instance;c.__instance=this}a.SUPER.call(this,b)}function f(a,c){var d=a.toString(),d=d.replace(/\s*function\s*\([\w\s,_\d\$]*\)\s*\{/,
""),d=d.substring(0,d.lastIndexOf("}")),d=d.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)/g,'$1"${$2}"'),d=d.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),d=d.replace(/(["']\s*\+\s*)\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)/g,'$1"${$2}"'),d=d.replace(/\s*_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"\s*\)(\s*\+\s*["'])/g,'"${$1}"$2'),d=d.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*'([^']*)'(\s*)\)/g,"$1${$2}$3"),d=
d.replace(/(\s*)_*\w+\s*\.\s*valueForToken\s*\(\s*"([^"]*)"(\s*)\)/g,"$1${$2}$3"),d=c.replaceTokensWithValues(d);e.geval(d)}var e=h.opentag.Utils,d=h.Define;h.Define.clazz("qubit.opentag.LibraryTag",a,h.opentag.BaseTag);a.defaultConfig={vendor:null,imageUrl:null,description:"",async:!1,isPrivate:!1,upgradeable:!0,html:"",parameters:[],prePostWindowScope:!1};a.prototype.pre=function(){};a.prototype.post=function(){};a.prototype.before=function(){a.SUPER.prototype.before.call(this);try{var b=this.config;
if(b&&b.pre)if("function"===typeof b.pre)this.pre=b.pre;else{var c=this.replaceTokensWithValues(String(b.pre));this.pre=e.expressionToFunction(c).bind(this)}this.config.prePostWindowScope&&this.pre!==a.prototype.pre&&this.pre.toString?f(this.pre,this):this.pre()}catch(d){return!0}return!1};a.prototype.after=function(b){a.SUPER.prototype.after.call(this,b);try{var c=this.config;if(c&&c.post)if("function"===typeof c.post)this.post=c.post;else{var d=this.replaceTokensWithValues(String(c.post));this.post=
e.expressionToFunction(d).bind(this)}this.config.prePostWindowScope&&this.post!==a.prototype.post&&this.post.toString?f(this.post,this):this.post(b)}catch(h){}};a.define=function(b,c){b=b.replace(/^[\.]+/g,"").replace(/[\.]+$/g,"").replace(/\.+/g,".");b=h.Define.vendorsSpaceClasspath(b);var f={};c.getDefaultConfig&&(f=c.getDefaultConfig());var l=c.CONSTRUCTOR,g={},p;for(p in c)"config"!==p&&(g[p]=c[p]);g=h.opentag.Utils.defineWrappedClass(b,a,g,y,function(a){a=a||{};a=e.overrideFromLeftToRight(f,
a);var b=h.opentag.LibraryTag.call(this,a);l&&l.call(this,a);if(b)return b});p=d.STANDARD_VS_NS+".";0!==b.indexOf(p)&&e.namespace(p+b,g);return g};a.getLibraryByClasspath=function(a){return e.getObjectUsingPath(a,h.Define.getVendorSpace())}})();(function(){function a(){}var f=h.opentag.LibraryTag,e=h.Define;a.library=function(){return f.define.apply(f,arguments)};a.libraryRef=function(){return f.getLibraryByClasspath.apply(f.getLibraryByClasspath,arguments)};e.namespace("qubit.Quick",a)})();(function(){function a(b){this.runQueue=
[];this.tags={};this.config={cookieDomain:"",maxCookieLength:1E3,gzip:!0,delayDocWrite:!1,clientId:"",name:"",tellLoadTimesProbability:null,pingServerUrl:null,trackSession:null,disabled:!1,containerId:"",scanTags:!1,noPings:!1};this.ignoreTagsState=!1;if(b){this.setConfig(b);b.name||(this.config.name="Cont-"+r++);a.register(this);a.NO_PINGS&&(this.config.noPings=!0);this.ping=new h.opentag.Ping(this.config);this._sendPingsTrigger=this.sendPings.bind(this);if(b.init)try{b.init.call(this,b)}catch(c){}var d=
this;this._tagLoadedHandler=function(a){d._containerAlreadySentPings&&d.sendPingsNotTooOften()}}return this}function f(a,b,c){a[c]&&(m[c]=m[c]||1,c+="("+m[c]+")",m[c]++);a[c]=b}var e=h.opentag.Utils,d=h.opentag.filter.BaseFilter,b=h.opentag.filter.Filter,c=h.opentag.BaseTag,k=h.opentag.Timed,l=h.opentag.Tags,g=h.opentag.Session,p=h.Cookie,r=1;try{window.opentag_consentGiven=function(){a.consentIsGiven=!0;for(var b=a.getContainers(),c=0;c<b.length;c++)try{b[c].run()}catch(d){}}.bind(this)}catch(q){}h.Define.clazz("qubit.opentag.Container",
a);var t=[];a.register=function(a){e.addToArrayIfNotExist(t,a)};a.prototype.isTellingLoadTimes=function(){var a=this.config.tellLoadTimesProbability;null===a&&(a=0);return a>Math.random()};a.prototype.destroy=function(a){this.destroyed=!0;this.unregister();if(a)for(var b in this.tags)a=this.tags[b],a instanceof c&&(a.destroy(),this.tags[b]=null,delete this.tags[b]);b=this.PACKAGE_NAME.split(".");b=b[b.length-1];a=e.getParentObject(this.PACKAGE_NAME);a[b]=null;delete a[b]};a.findContainersByName=function(a){for(var b=
this.getContainers(),c=[],d=0;d<b.length;d++)b[d].config.name===a&&c.push(b[d]);return c};a.getById=function(a){for(var b=this.getContainers(),c=0;c<b.length;c++)if(b[c].getContainerId()===a)return b[c];return null};a.prototype.unregister=function(b){a.unregister(this,b)};a.unregister=function(a,b){e.addToArrayIfNotExist(t,a);e.removeFromArray(t,a);if(b)for(var d in this.tags){var f=this.tags[d];f instanceof c&&(f.unregister(),this.tags[d]=null,delete this.tags[d])}};a.prototype.hasConsent=function(){return"Accepted"===
p.get("qubitconsent")};a.prototype.register=function(b){a.register(b||this)};a.getContainers=function(){return t};a.prototype.getContainers=function(){return a.getContainers()};a.prototype.onTagRegistered=function(a){};a.prototype.registerTag=function(a){var b=a.config.name;if(!this.tags[b]){this.tags[b]=a;a.onAfter(this._tagLoadedHandler);try{this.onTagRegistered(a)}catch(c){}}};a.prototype.registerTags=function(a){for(var b=0;b<a.length;b++)this.registerTag(a[b])};a.prototype.setConfig=function(a){for(var b in a)this.config[b]=
a[b]};a.prototype.run=function(){this.runTags({command:"runOnceIfFiltersPass"})};a.prototype.runWithoutFilters=function(){this.runTags({command:"run"})};a.prototype.getTagByname=function(a){return this.tags[a]};a.prototype.containerScriptLoadedSynchronously=function(){var a,b,c,d,e;d=document.getElementsByTagName("script");a=0;for(b=d.length;a<b;a+=1)if(c=d[a],(e=c.getAttribute("src"))&&0<e.indexOf(""+this.config.clientId+"-"+this.getContainerId()+".js"))return null===c.getAttribute("async")&&(!1===
c.getAttribute("defer")||""===c.getAttribute("defer")||null===c.getAttribute("defer"));return!0};a.prototype.prepareSessionIfNeeded=function(){var c=this.config.trackSession;if(!0!==c&&!1!==c){var c=this.tags,d;for(d in c)if(c.hasOwnProperty(d)){var e=c[d];e.resolveAllDynamicData();for(var e=e.getFilters(),f=0;f<e.length;f++){var h=e[f];if(h instanceof b&&h.isSession()){this.trackSession=!0;break}}if(this.trackSession)break}}else this.trackSession=c;a.TRACK_SESSION&&(this.trackSession=!0);this.trackSession&&
(this.session=g.setupSession(this))};a.prototype.runTags=function(b,c){if(this.destroyed)throw"Container has been destroyed.";if(c||!a.LOCKED&&!e.global().QUBIT_CONTAINERS_LOCKED){if(this.onBeforeRun)try{this.onBeforeRun()}catch(d){}var f=!this.containerScriptLoadedSynchronously(),g="runIfFiltersPass";b&&b.command&&(g=b.command);this.runningStarted=(new Date).valueOf();var h={};this.config.scanTags&&!this._scanned&&(this.scanForTags(),this._scanned=(new Date).valueOf());this.prepareSessionIfNeeded();
for(var l=this.getTagsInOrder(),m=0;m<l.length;m++)try{var p=l[m],q=p.config.name;if(this.includedToRun(p)){var r=p.resolveDependencies();if(0<r.length)for(var t=0;t<r.length;t++){var v=r[t],x=v.config.name;!h[x]&&this.tags[x]&&(h[x]=v,this._tagRunner(v,g,f))}h[q]||(h[q]=p,this._tagRunner(p,g,f))}}catch(y){}k.setTimeout(function(){this.sendPingsNotTooOften()}.bind(this),1100);this.waitForAllTagsToFinish()}};a.prototype.getTagsInOrder=function(){var a=[],b;for(b in this.tags){var c=this.tags[b],d=
c.config.priority;if(0<+d){for(var e=0,f=0;f<a.length;f++){var g=a[f];if(g)if(g=+g.config.priority,0<g&&g>d)e++;else break}a.splice(e,0,c)}else a.push(c)}return a};a.prototype._tagRunner=function(a,b,c){try{this.includedToRun(a)&&(c&&(a.forceAsynchronous=!0),this.config.delayDocWrite&&(a.delayDocWrite=!0),a.session=a.session||this.session,a[b]())}catch(d){}};a.prototype.getContainerId=function(){if(this.config.containerId)return this.config.containerId;if(this._pkgName)return this._pkgName;var a=
this.PACKAGE_NAME.split(".");return this._pkgName=a=a[a.length-1]};a.prototype.includedToRun=function(b){if(!b)return!1;var d=b.config;if(d.inactive||d.disabled&&!b.cookieSaysToRunEvenIfDisabled()||b.disabledByCookie())return!1;d=a.consentIsGiven||!d.needsConsent||this.hasConsent();b=b.state===c.prototype.STATE.INITIAL;return this.ignoreTagsState||d&&b};a.prototype.scanForTags=function(a,b){a&&(this.tags={});var c;c=b&&"object"===typeof b?this.findAllTags(b):this.findAllTagsByClassPath();this.registerTags(c);
return c};a.prototype.findAllTags=function(a,b){a=a||this.tagsPackageName||this.PACKAGE_NAME;return l.findAllTags(a,b)};a.prototype.findAllTagsByClassPath=function(a){a=a||this.PACKAGE_NAME;return l.findAllTagsByClassPath(a)};a.prototype.findAllFilters=function(a,b){a=a||this.tagsPackageName||this.PACKAGE_NAME;return l.findAllFilters(a,b)};a.prototype.waitForAllTagsToFinish=function(){if(!this._waitForAllTagsToFinishWaiting){this._lastWaited||(this._lastWaited=(new Date).valueOf());var a=15E3<(new Date).valueOf()-
this._lastWaited,a=this.allTagsFinished()||a;if(!this._showFinishedOnce&&a){if(this._lastWaited=null,this._showFinishedOnce=!0,this.runningFinished=(new Date).valueOf(),this._containerAlreadySentPings=(new Date).valueOf(),this.sendPingsNotTooOften(),this.onTagsInitiallyRun)this.onTagsInitiallyRun()}else a||(this._waitForAllTagsToFinishWaiting=!0,this._showFinishedOnce=!1,k.setTimeout(function(){this._waitForAllTagsToFinishWaiting=!1;this.waitForAllTagsToFinish()}.bind(this),100))}};a.prototype.onTagsInitiallyRun=
x;a.prototype.resetAllTags=function(a){for(var b in this.tags)if(this.tags.hasOwnProperty(b)){var c=this.tags[b];c.reset();a||c.resetFilters()}};a.prototype.reset=function(a){this._showFinishedOnce=this.runningStarted=this._waitForAllTagsToFinishWaiting=this.runningFinished=void 0;this.resetAllTags(a)};a.prototype.sendPingsNotTooOften=function(){this._sndLck=this._sndLck||{};k.runIfNotScheduled(this._sendPingsTrigger,2E3,this._sndLck)};a.prototype.sendPings=function(){if(!this.config.noPings){var a;
if(this.isTellingLoadTimes()){var b=this.getAllTagsByState(),c;b.run&&(c=l.getLoadTimes(b.run),this.lastPingsSentTime=(new Date).valueOf(),this.ping.send(this,c));c=l.getLoadTimes();var d=[];for(a=0;a<c.length;a++){var e=c[a].tag;e.config.dedupe&&e.sendDedupePing&&d.push(e)}0<d.length&&(this.lastDedupePingsSentTime=(new Date).valueOf(),this.ping.sendDedupe(this,d));if(b.other){c=l.getLoadTimes(b.other);d=[];for(a=0;a<c.length;a++)d.push(c[a]);0<d.length&&this.ping.send(this,d)}if(b.awaiting){c=l.getLoadTimes(b.awaiting);
b=[];for(a=0;a<c.length;a++)b.push(c[a]);0<b.length&&this.ping.send(this,b)}}}};a.prototype.getAllTagsByState=function(){return a.getAllTagsByState(this.tags)};a.getAllTagsByState=function(a){var b=null,e=null,g=null,h=null,k=null,l=null,m=c.prototype.STATE.EXECUTED_WITH_ERRORS,p;for(p in a){var q=a[p];if(q instanceof c){var r=q.config.name;0<q.scriptExecuted?(b=b||{},f(b,q,r)):q.locked?(l=l||{},f(l,q,r)):0>q.scriptExecuted||q.state>=m?(h=h||{},f(h,q,r)):q.filtersState()===d.state.SESSION||0<q.filtersState()?
(g=g||{},f(g,q,r)):q.config.needsConsent?(k=k||{},f(k,q,r)):(e=e||{},f(e,q,r))}}return{run:b,failed:h,awaiting:g,consent:k,locked:l,other:e}};var m={};a.prototype.allTagsFinished=function(){for(var a in this.tags)if(this.tags.hasOwnProperty(a)){var b=this.tags[a];if(b instanceof h.opentag.BaseTag){var c=b.filtersState();if(!b.config.disabled){var e=0>b.filtersState()&&!b.locked,f=!(b.finished()||b.config.runner&&!b.isRunning);if(e&&f&&(b=0<+b.awaitingDependencies,c!==d.state.SESSION&&!b))return!1}}}return!0};
a.prototype.getPageVariables=function(){var a=[],b;for(b in this.tags)if(this.tags.hasOwnProperty(b))for(var c=this.tags[b].getPageVariables(),d=0;d<c.length;d++)e.addToArrayIfNotExist(a,c[d]);return a};a.getPageVariableByName=function(a){for(var b=this.getAllPageVariables(),c=[],d=0;d<b.length;d++)b[d].config.name===a&&c.push(b[d]);return c};a.prototype._getCookieNameForDisabling=function(){return"qubit.opentag.disableContainerRunning_"+this.getContainerId()+this.config.name};a.prototype.disabledByCookie=
function(){return!!p.get(this._getCookieNameForDisabling())};a.prototype.setCookieToDisable=function(){p.set(this._getCookieNameForDisabling(),"true")};a.prototype.rmCookieToDisable=function(){p.rm(this._getCookieNameForDisabling())};a.rmAllDisablingCookies=function(){e.rmCookiesMatching("qubit.opentag.disableContainerRunning_")};a.setCookieForDisabledContainersToRun=function(){p.set("qubit.opentag.forceContainerRunning","true")};a.rmCookieForDisabledContainersToRun=function(){p.rm("qubit.opentag.forceContainerRunning")}})();
(function(){function a(e){f.setIfUnset(e,{url:null,html:"",locationPlaceHolder:"NOT_END",locationObject:"BODY",async:!0});a.SUPER.call(this,e)}var f=h.opentag.Utils;h.Define.clazz("qubit.opentag.CustomTag",a,h.opentag.LibraryTag)})();(function(){var a={callbacks:{},unfired_events:[],early_callbacks:null,currentUV:null},f,e="universal_variable";a._isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a._targetChanged=function(d,b,c){if(null===c)return"null"===b?!1:!0;if(void 0===
c)return b===c?!1:!0;b=z.parse(b);b=a._getNested(b,d);d=a._getNested(c,d);return!a._jsonIsEqual(b,d)};a._processCallbacks=function(){var d;if(a.early_callbacks&&0<a.early_callbacks.length){for(d=0;d<a.early_callbacks.length;d+=1)a.push(a.early_callbacks[d]);a.early_callbacks=null}};a._keyStringToArr=function(a){a=a.replace(/^\s+/,"").replace(/\s+$/,"");if(""===a)return[];a=a.replace(/\[(\w+)\]/g,".$1");a=a.replace(/^\./,"");return a.split(".")};a._getNested=function(d,b){for(var c=a._keyStringToArr(b),
e;0<c.length;)if(e=c.shift(),d.hasOwnProperty(e))d=d[e];else return;return d};a._jsonIsEqual=function(d,b){"string"!==typeof d&&(d=z.stringify(d,a._stripEvents));"string"!==typeof b&&(b=z.stringify(b,a._stripEvents));return d===b};a._stripEvents=function(a,b){if("events"!==a)return b};a._on=function(d,b){var c;c=d.split(":");d=c[0];c=c[1];a.callbacks[d]=a.callbacks[d]||[];c?a.callbacks[d].push({keyString:c,func:b}):a.callbacks[d].push({func:b})};a._trigger=function(d,b){var c,e;if(a.callbacks[d])for(c=
0;c<a.callbacks[d].length;c+=1)"function"===typeof a.callbacks[d][c].func&&((e=a.callbacks[d][c].keyString)?"change"===d&&a._targetChanged(e,a.currentUV,f)&&a.callbacks[d][c].func(b):a.callbacks[d][c].func(b))};a._eventsPush=function(d){var b,c;f.events[f.events.length]=d;d.time=d.time||(new Date).getTime();if(a.callbacks.event)for(b=0,c=a.callbacks.event.length,b;b<c;b+=1)a.callbacks.event[b].func(d);d.has_fired=!0};a._getUnfiredEvents=function(){for(var d=0,d=0;d<f.events.length;d+=1)f.events[d].has_fired||
(a.unfired_events.push(f.events.splice(d,1)[0]),d-=1)};a._fireEvents=function(){for(;0<a.unfired_events.length;)f.events.push(a.unfired_events.shift())};a._resetEventsPush=function(){f.events=f.events||[];-1!==f.events.push.toString().indexOf("[native code]")&&(f.events.push=a._eventsPush,a._getUnfiredEvents(),a._fireEvents())};a._checkForChanges=function(){a.callbacks.change&&0<a.callbacks.change.length&&!a._jsonIsEqual(a.currentUV,f)&&(a._trigger("change",f),a.currentUV=z.stringify(f,a._stripEvents))};
a._setUVLocation=function(d){e=d;a._initUV()};a._initUV=function(){window[e]=window[e]||{events:[]};f=window[e];f.events||(f.events=[])};a.push=function(d){a._isArray(d)&&("on"===d[0]?a._on(d[1],d[2]):"trigger"===d[0]&&d[1]&&a._trigger(d[1]))};a.init=function(d,b){b&&(e=b);a._initUV();!window.uv_listener||a._isArray(window.uv_listener)?(a.early_callbacks=window.uv_listener||null,window.uv_listener=a,d||a.start()):b&&window.uv_listener._setUVLocation(e)};a.start=function(){a.currentUV=z.stringify(f,
a._stripEvents);setInterval(function(){a._initUV();a._resetEventsPush();a._checkForChanges()},500);a._processCallbacks()};t.UVListener=a})();(function(){function a(){}function f(a,c,d){!d||void 0!==a[c]&&""!==a[c]&&null!==a[c]||(a[c]=d)}var e=h.Cookie,d=h.opentag.Utils;h.opentag.Log.setLevelFromCookie();a.run=function(){var b=!1,c;a:{try{var d=y.TAGSDK_MAIN_DISABLED_FUNCTION;if(d&&d()){c=!0;break a}}catch(f){}c=0<=document.location.href.indexOf("opentag_disabled=true")?!0:!1}if(!c){c=!1;if(e.get("opentag_debug_tool")||
0<=document.location.href.indexOf("opentag_debug_tool"))c=!0;!c&&(c=!1,e.get("opentag_debug")||0<=document.location.href.indexOf("opentag_debug"))&&(c=!0);c&&(y.TAGSDK_NS_OVERRIDE=h.DEBUG_MODE?!1:!0,b=!0);h.DEBUG_MODE&&(y.TAGSDK_NS_OVERRIDE=!1);try{t.UVListener.init()}catch(g){}a.runAllContainers(b)}};a.runAllContainers=function(b){try{for(var c=h.opentag.Container.getContainers(),e=0;e<c.length;e++){var l=c[e],g=l.config;if(!l.runningStarted&&!l.configuredInMain){g.scanTags=!0;var p=d.getParentObject(l.PACKAGE_NAME).ClientConfig;
p&&f(l.config,"clientId",p.id);var r=d.getParentObject(l.PACKAGE_NAME).SystemDefaults;r&&(f(g,"pingServerUrl",r.pingServerUrl),f(g,"tellLoadTimesProbability",r.tellLoadTimesProbability));l.configuredInMain=!0;b?(l.destroy(!0),a.loadDebugVersion(l)):y.QUBIT_OPENTAG_STOP_MAIN_EXECUTION?function(){var a=h.opentag.RUN_STOPPED_EXECUTON;h.opentag.RUN_STOPPED_EXECUTON=function(){try{a&&a()}finally{l.run()}}}(l):l.run()}}}catch(q){}};a.loadDebugVersion=function(a){var c=document.createElement("script"),d,
e=a.config.scriptURL,f;(f=h.opentag.Utils.getParentObject(a.PACKAGE_NAME).ClientConfig)&&f.clientId?f=f.clientId:(f=a.PACKAGE_NAME.split("."),f=f[f.length-2].substring(1));a=a.getContainerId();e&&(d=e,d.lastIndexOf("-debug.js")!==d.length-9&&(d=d.substring(0,d.length-3),d+="-debug.js"));c.src=d&&"//d3c3cq33003psk.cloudfront.net/opentag-"+f+"-"+a+"-debug.js"!==d?d:"//s3-eu-west-1.amazonaws.com/opentag/opentag-"+f+"-"+a+"-debug.js";document.getElementsByTagName("head")[0].appendChild(c)};h.Define.namespace("qubit.opentag.Main",
a)})();var C=!1;try{"object"===typeof module&&module.exports&&(module.exports=J,C=!0)}catch(Q){}!C&&window&&(window.uv=J());var H={},E=[],K=!1,I=!1,G=h.Define.global(),C={allEventsByType:H,subscribe:function(a,f){if(I)G.uv.on(a,f);else E.push({on:[a,f]})},getEventHistory:function(a){return this.allEventsByType[a]},publish:function(a,f){I?G.uv.emit(a,f):E.push({emit:[a,f]})},connect:function(){L()}};C.connect();h.Define.namespace("qubit.qprotocol.PubSub",C);(function(){function a(d){a.SUPER.apply(this,
arguments)}var f=h.qprotocol.PubSub,e=h.opentag.Utils;h.Define.clazz("qubit.opentag.pagevariable.QProtocolVariable",a,h.opentag.pagevariable.BaseVariable);a.prototype.init=function(){if(this.initialized)return!1;this.initialized=(new Date).valueOf();this.callHandlersOnRead=!0;if(!this.handlerAttached){var a=this,b=this.getValueAndPath(this.value);this.eventName=b[0];this.objectPath=b[1];this.updateValue();f.subscribe(this.eventName,function(b){a.updateValue(b)});this.handlerAttached=(new Date).valueOf()}};
a.prototype.getValueAndPath=function(a){var b=a,c;if(b){var e=a.indexOf(":");-1!==e&&(b=a.substring(0,e),c=a.substring(e+1))}return[b,c]};a.prototype.getValue=function(){this.init();return this.currentValue};a.prototype.getEventsHistory=function(){return f.getEventHistory(this.eventName)};a.prototype.updateValue=function(a){if(!a){var b=this.getEventsHistory();b&&(a=b.current)}b=this.objectPath;a=a&&b?e.getObjectUsingPath(b,a):a;this._updateCurrentValue(a);return a};a.prototype.startObservingForChanges=
function(){};a.prototype.stopObservingForChanges=function(){}})();(function(){function a(f){a.SUPER.apply(this,arguments)}h.Define.clazz("qubit.opentag.pagevariable.UniversalVariable",a,h.opentag.pagevariable.Expression)})()})();
